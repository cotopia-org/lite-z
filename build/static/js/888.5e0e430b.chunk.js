"use strict";(self.webpackChunkffd_organization_panel=self.webpackChunkffd_organization_panel||[]).push([[888],{6561:(e,t,s)=>{s.d(t,{A:()=>c});var l=s(5043),n=s(8276),i=s(8818),a=s(579);const r=l.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(n.bL,{ref:t,className:(0,i.cn)("relative flex h-6 w-6 shrink-0 overflow-hidden rounded-full",s),...l})}));r.displayName=n.bL.displayName;const o=l.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(n._V,{ref:t,className:(0,i.cn)("aspect-square h-full w-full",s),...l})}));o.displayName=n._V.displayName;const d=l.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(n.H4,{ref:t,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...l})}));function c(e){let{title:t,src:s,...l}=e;return(0,a.jsxs)(r,{...l,children:[(0,a.jsx)(o,{draggable:!1,className:"object-cover object-center",src:s}),(0,a.jsx)(d,{className:"uppercase",children:t})]})}d.displayName=n.H4.displayName},9736:(e,t,s)=>{s.d(t,{A:()=>a});var l=s(2043),n=s(9772),i=s(579);function a(e){var t,s,a;let{loading:r,startIcon:o,endIcon:d,...c}=e;const u=null!==(t=null!==(s=null===c||void 0===c?void 0:c.disabled)&&void 0!==s?s:r)&&void 0!==t&&t;let x=null!==(a=null===c||void 0===c?void 0:c.className)&&void 0!==a?a:"";return x+=" gap-x-2 px-2",(0,i.jsx)(n.$,{type:"button",...c,className:x,disabled:u,children:r?(0,i.jsx)(l.A,{className:"animate-spin"}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex flex-row items-center gap-x-1",children:[!!o&&o,null===c||void 0===c?void 0:c.children]}),!!d&&(0,i.jsx)("div",{children:d})]})})}},10:(e,t,s)=>{s.d(t,{A:()=>i});var l=s(9736),n=s(579);function i(e){var t;let{loading:s,...i}=e,a=null!==(t=null===i||void 0===i?void 0:i.className)&&void 0!==t?t:"";return a+=" flex flex-col !p-0 items-center justify-center bg-white rounded-full hover:bg-gray-100",(0,n.jsx)(l.A,{variant:"default",size:"icon",...i,className:a,children:null===i||void 0===i?void 0:i.children})}},4715:(e,t,s)=>{s.d(t,{A:()=>i});var l=s(9954),n=s(579);function i(e){var t;let{label:s,helperText:i,hasError:a,renderInput:r,...o}=e,d=null!==(t=null===o||void 0===o?void 0:o.className)&&void 0!==t?t:"",c="text-sm font-normal text-black/60";a&&(d+=" border !ring-red-600 border-red-600",c+=" text-red-600");const u=(0,n.jsx)(l.p,{...o,className:d});return(0,n.jsxs)("div",{className:"flex flex-col items-start gap-y-2 w-full",children:[s&&(0,n.jsx)("strong",{className:"font-semibold text-black/[.87] text-base",children:s}),r?r(u):u,i&&(0,n.jsx)("span",{"data-testid":"hint-text",className:c,children:i})]})}},8623:(e,t,s)=>{s.d(t,{A:()=>i});var l=s(2043),n=s(579);function i(e){let{className:t}=e;return(0,n.jsx)("div",{className:`h-full w-full flex flex-col items-center ${null!==t&&void 0!==t?t:""}`,children:(0,n.jsx)(l.A,{className:"animate-spin"})})}},3574:(e,t,s)=>{s.d(t,{A:()=>n});var l=s(579);function n(e){let{icon:t,title:s,desc:n,afterDesc:i,className:a}=e;return(0,l.jsxs)("div",{className:`items-center flex flex-col gap-y-4 ${null!==a&&void 0!==a?a:""}`,children:[!!t&&t,(0,l.jsx)("strong",{className:"text-base font-normal text-black/[.60]",children:s}),!!n&&(0,l.jsx)("p",{className:"text-sm text-black/60",children:n}),!!i&&i]})}},74:(e,t,s)=>{s.d(t,{A:()=>n});var l=s(579);function n(e){let{title:t,action:s,children:n}=e;return(0,l.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,l.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,l.jsx)("h2",{className:"font-medium text-gray-700 text-3xl",children:t}),!!s&&s]}),!!n&&(0,l.jsx)("div",{className:"children",children:n})]})}},567:(e,t,s)=>{s.d(t,{A:()=>h});var l=s(6561),n=s(579);function i(e){let{title:t}=e;return(0,n.jsx)(l.A,{src:"",title:t,className:"w-[44px] h-[44px]"})}function a(e){let{title:t}=e;return(0,n.jsx)("strong",{className:"font-medium text-lg text-gray-800",children:t})}var r=s(6178),o=s.n(r);function d(e){let{date:t}=e;if(null===t)return null;const s=t?o()(t).fromNow():null;return(0,n.jsx)("span",{className:"text-xs font-normal text-gray-600",children:`Created ${s}`})}var c=s(5043),u=s(5411),x=s(5475);function m(e){var t;let{item:s}=e;const[l,r]=(0,c.useState)(s);let o="";return s.title&&(o=l.title[0].toUpperCase()),(0,u.FO)("workspaceUpdated",(e=>{e.id===s.id&&r(e)})),(0,n.jsx)(x.N_,{to:`/workspaces/${l.id}`,className:"p-4 rounded-3xl bg-gray-50 hover:bg-gray-100 w-full flex flex-row items-center justify-between",children:(0,n.jsxs)("div",{className:"flex flex-row items-center gap-x-4",children:[(0,n.jsx)(i,{title:o}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)(a,{title:l.title}),(0,n.jsx)(d,{date:null!==(t=l.created_at)&&void 0!==t?t:null})]})]})})}var f=s(3574),v=s(2811);function h(e){let{items:t}=e;return 0===t.length?(0,n.jsx)(f.A,{className:"py-6",icon:(0,n.jsx)(v.A,{className:"text-black/60"}),title:"There is no workspace here!"}):(0,n.jsx)("div",{className:"flex flex-col gap-y-2",children:t.map((e=>(0,n.jsx)(m,{item:e},e.id)))})}},9772:(e,t,s)=>{s.d(t,{$:()=>d,r:()=>o});var l=s(5043),n=s(6851),i=s(435),a=s(8818),r=s(579);const o=(0,i.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=l.forwardRef(((e,t)=>{let{className:s,variant:l,size:i,asChild:d=!1,...c}=e;const u=d?n.DX:"button";return(0,r.jsx)(u,{className:(0,a.cn)(o({variant:l,size:i,className:s})),ref:t,...c})}));d.displayName="Button"},9954:(e,t,s)=>{s.d(t,{p:()=>a});var l=s(5043),n=s(8818),i=s(579);const a=l.forwardRef(((e,t)=>{let{className:s,type:l,...a}=e;return(0,i.jsx)("input",{type:l,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})}));a.displayName="Input"},6197:(e,t,s)=>{s.d(t,{L:()=>r,g:()=>a});var l=s(1331),n=s(404);const i={method:"GET",data:void 0,key:void 0,isFetch:!0},a=function(e,t){var s,a;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{shouldRetryOnError:!1},o=null===(s=null===t||void 0===t?void 0:t.isFetch)||void 0===s||s;return(0,n.Ay)(null!==(a=null===t||void 0===t?void 0:t.key)&&void 0!==a?a:e,(async()=>{if(!o)return;const s=null!==t&&void 0!==t?t:i;return(await(0,l.A)({method:s.method,url:e,data:s.data})).data}),{...r})},r=e=>(0,n.Ay)(e,(async()=>(await l.A.get(e,{baseURL:""})).data))},2888:(e,t,s)=>{s.r(t),s.d(t,{default:()=>Ya});var l=s(5517),n=s(6197),i=s(5043);const a=()=>{const[e,t]=(0,i.useState)(!1);return{isLoading:e,startLoading:()=>t(!0),stopLoading:()=>t(!1)}};var r=s(5475);const o=()=>{const[e]=(0,r.ok)();let t={};for(let[s,l]of e.entries())t[s]=l;return{query:t}};var d=s(8005);const c=()=>(0,d.GV)((e=>e.setting));var u=s(9885);const x={backgroundChanged:new u.Howl({src:["/assets/sounds-effects/background-changed.mp3"]}),coordinateChanged:new u.Howl({src:["/assets/sounds-effects/coordinate-changed.mp3"]}),newMessage:new u.Howl({src:["/assets/sounds-effects/new-message.mp3"]}),newMessage2:new u.Howl({src:["/assets/sounds-effects/new-message-2.wav"]}),userGotClosed:new u.Howl({src:["/assets/sounds-effects/user-got-closed.mp3"]}),left:new u.Howl({src:["/assets/sounds-effects/left.mp3"]}),joined:new u.Howl({src:["/assets/sounds-effects/joined.mp3"]}),elseUserleft:new u.Howl({src:["/assets/sounds-effects/else-user-left.mp3"]}),elseUserJoin:new u.Howl({src:["/assets/sounds-effects/else-user-join.mp3"]})},m=e=>{x[e]&&x[e].play()};var f=s(8818),v=s(5411),h=s(1331),p=s(3216),g=s(579);const j=(0,i.createContext)({room:void 0,livekit_token:void 0,room_id:1,workspace_id:void 0,sidebar:void 0,updateUserCoords:(e,t)=>{},openSidebar:e=>{},closeSidebar:()=>{},audioState:!1,videoState:!1,changePermissionState:(e,t)=>{},joinRoom:()=>{},leaderboard:[],scheduled:[],workpaceUsers:[],workspaceJobs:[],workingUsers:[],onlineUsers:[],usersHaveJobs:[],usersHaveInProgressJobs:[]}),b=()=>(0,i.useContext)(j);function w(e){var t,s;let{children:l,room_id:r,workspace_id:d}=e;const[u,x]=(0,i.useState)(),{startLoading:b,stopLoading:w,isLoading:y}=a();(0,i.useEffect)((()=>{var e;e=r,b(),h.A.get(`/rooms/${e}`).then((async e=>{var t;x(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.data),w()})).catch((e=>{w()}))}),[r]),(0,v.FO)("roomUpdated",(e=>{x(e)}));const N=c(),{query:k}=o(),A=null!==(t=null===k||void 0===k?void 0:k.token)&&void 0!==t?t:void 0,C=(0,v.FO)(),S=(0,p.Zp)(),[_,R]=(0,i.useState)({audio:!0,video:!0}),[E,z]=(0,i.useState)((0,g.jsx)(g.Fragment,{})),{data:L}=(0,n.g)(`/workspaces/${d}/leaderboard`),T=void 0!==L?L.data:[],{data:P}=(0,n.g)(`/workspaces/${d}/schedules`),D=void 0!==P?null===P||void 0===P?void 0:P.data:[],{data:I,mutate:$}=(0,n.g)(`/workspaces/${d}/users`),M=void 0!==I?null===I||void 0===I?void 0:I.data:[];(0,v.FO)("userLeftFromRoom",(e=>{var t;if($(),void 0===u)return;if(r!==e.room_id)return;const s=(null!==(t=null===u||void 0===u?void 0:u.participants)&&void 0!==t?t:[]).filter((t=>t.id!==e.user.id));u.participants=s,x(u)}),[u,$]),(0,v.FO)("userJoinedToRoom",(e=>{var t;if($(),void 0===u)return;if(r!==e.room_id)return;const s=null!==(t=null===u||void 0===u?void 0:u.participants)&&void 0!==t?t:[];u.participants=[...s,e.user],x(u)}),[u,$]);const{data:O}=(0,n.g)(`/workspaces/${d}/jobs`),V=void 0!==O?null===O||void 0===O?void 0:O.data:[];let U=[];for(let n of V)for(let e of n.members)U.push(e.id);const F=(0,i.useMemo)((()=>{let e=[];for(let t of V)for(let s of t.members)e.push(s);return(0,f.ar)(e)}),[V]),H=(0,i.useMemo)((()=>{let e=[];for(let t of V)if("in_progress"===t.status)for(let s of t.members)e.push(s);return(0,f.ar)(e)}),[V]),J=H.map((e=>e.id)),G=T.filter((e=>1===e.user.active&&null!==e.user.room_id&&e.user.workspace_id===+d&&U.includes(e.user.id)&&J.includes(e.user.id))).map((e=>e.user)),q=T.filter((e=>1===e.user.active&&"online"===e.user.status&&e.user.workspace_id===+d)).map((e=>e.user));return(0,g.jsx)(j.Provider,{value:{room:u,room_id:+r,workspace_id:d,sidebar:E,closeSidebar:()=>z(void 0),openSidebar:e=>z(e),updateUserCoords:(e,t)=>{var s;if(!C)return;if(void 0===u)return;const l=null!==(s=null===u||void 0===u?void 0:u.participants)&&void 0!==s?s:[],n=l.findIndex((t=>t.username===e));if(-1===n)return x(u);l[n]={...l[n],coordinates:`${t.x},${t.y}`},console.log("participants[participant_index]",l[n]),x({...u,participants:l})},audioState:_.audio,videoState:_.video,changePermissionState:(e,t)=>{R((s=>({...s,[e]:t})))},livekit_token:null!==(s=A)&&void 0!==s?s:void 0,joinRoom:async()=>{C&&C.emit("joinedRoom",r,(()=>{h.A.get(`/rooms/${r}/join`).then((e=>{const t=e.data.data.token;if(t)return N.sounds.userJoinLeft&&m("joined"),void S(`/workspaces/${d}/rooms/${r}?token=${t}`)}))}))},leaderboard:T,scheduled:D,workpaceUsers:M,workspaceJobs:V,workingUsers:G,onlineUsers:q,usersHaveJobs:F,usersHaveInProgressJobs:H},children:l})}function y(e){let{children:t}=e;return(0,g.jsx)("div",{className:"min-h-screen overflow-y-auto",children:(0,g.jsx)("div",{className:"bg-white min-h-screen w-full",children:t})})}var N=s(4519);const k=N.bL,A=i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(N.B8,{ref:t,className:(0,f.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...l})}));A.displayName=N.B8.displayName;const C=i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(N.l9,{ref:t,className:(0,f.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...l})}));C.displayName=N.l9.displayName;const S=i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(N.UC,{ref:t,className:(0,f.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...l})}));function _(e){let{defaultValue:t,title:s,items:l,className:n,titleClassName:i,dividerBetweenContentAndTabs:a=!1,onChangeTab:r}=e,o="w-full flex flex-col";a&&(o+=" gap-y-4"),n&&(o+=` ${n}`);return(0,g.jsxs)(k,{defaultValue:t,className:o,onValueChange:e=>{r&&r(e)},children:[(0,g.jsxs)("div",{className:"tab-holder flex flex-row items-center justify-between",children:[(0,g.jsx)(A,{className:"flex flex-row justify-start bg-black/5",children:l.map((e=>(0,g.jsx)(C,{value:e.value,children:e.icon?e.icon:e.title},e.value)))}),s&&"string"===typeof s?(0,g.jsx)("strong",{className:null!==i&&void 0!==i?i:"",children:s}):s]}),!!a&&(0,g.jsx)("hr",{}),l.map((e=>(0,g.jsx)(S,{value:e.value,className:"tab-content",children:e.content},e.value)))]})}S.displayName=N.UC.displayName;var R=s(2874),E=s(38),z=s(7118),L=s(9736);function T(){return(0,g.jsx)("div",{className:"flex flex-row items-center",children:["Rooms","Direct"].map((e=>(0,g.jsx)(L.A,{variant:"link",children:e},e)))})}var P=s(5179),D=s(614);const I=P.bL,$=P.l9,M=P.ZL,O=P.bm,V=i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(P.hJ,{ref:t,className:(0,f.cn)("fixed inset-0 bg-black/80 z-[10] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...l})}));V.displayName=P.hJ.displayName;const U=i.forwardRef(((e,t)=>{let{className:s,children:l,...n}=e;return(0,g.jsxs)(M,{children:[(0,g.jsx)(V,{}),(0,g.jsxs)(P.UC,{ref:t,className:(0,f.cn)("fixed left-[50%] top-[50%] grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg z-[10]",s),...n,children:[l,(0,g.jsxs)(P.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,g.jsx)(D.A,{className:"h-4 w-4"}),(0,g.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}));U.displayName=P.UC.displayName;const F=e=>{let{className:t,...s}=e;return(0,g.jsx)("div",{className:(0,f.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};F.displayName="DialogHeader";const H=e=>{let{className:t,...s}=e;return(0,g.jsx)("div",{className:(0,f.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};H.displayName="DialogFooter";const J=i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(P.hE,{ref:t,className:(0,f.cn)("text-lg font-semibold leading-none tracking-tight",s),...l})}));J.displayName=P.hE.displayName;const G=i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(P.VY,{ref:t,className:(0,f.cn)("text-sm text-muted-foreground",s),...l})}));function q(e){var t;let{trigger:s,children:l,className:n,hasClose:a=!0}=e;const[r,o]=(0,i.useState)(!1),d=()=>{o(!0)};let c=null!==n&&void 0!==n?n:"";return a||(c+=" [&_.right-4]:hidden"),(0,g.jsxs)(I,{open:r,onOpenChange:o,children:[(0,g.jsx)($,{asChild:!0,children:s(d)}),(0,g.jsx)(U,{className:null!==(t=c)&&void 0!==t?t:"",children:l?l(d,(()=>{o(!1)})):null})]})}function B(e){let{...t}=e,s="max-w-full max-h-[calc(100vh-200px)] overflow-y-auto z-[10]";return null!==t&&void 0!==t&&t.className&&(s+=` ${t.className}`),(0,g.jsx)(q,{...t,className:s})}G.displayName=P.VY.displayName;var Y=s(4715),W=s(3516),X=s(1360),K=s(6328),Z=s(899);function Q(e){let{workspace_id:t,onSubmit:s}=e;const{isLoading:l,startLoading:n,stopLoading:i}=a(),{touched:r,errors:o,getFieldProps:d,handleSubmit:c}=(0,W.Wx)({initialValues:{title:""},validationSchema:Z.Ik().shape({title:Z.Yj().required("Title is required")}),onSubmit:async(e,l)=>{n(),h.A.post("/chats",{type:"group",title:e.title,workspace_id:t}).then((e=>{s&&s(),i(),K.oR.success("Channel created.")})).catch((e=>{i()}))}});return(0,g.jsxs)("form",{onSubmit:c,className:"flex flex-col gap-y-4 items-start w-full",children:[(0,g.jsx)(Y.A,{...d("title"),hasError:!!r.title&&!!o.title,helperText:!!r.title&&!!o.title&&o.title,placeholder:"Title"}),(0,g.jsx)(L.A,{loading:l,type:"submit",className:"!px-4",startIcon:(0,g.jsx)(X.A,{size:20}),children:"Create Channel"})]})}var ee=s(10);function te(e){let{workspace_id:t}=e;return(0,g.jsx)(q,{trigger:e=>(0,g.jsx)("div",{className:"w-full",children:(0,g.jsx)(ee.A,{className:"text-gray-600 absolute bottom-4 right-4 z-10 shadow-lg w-12 h-12",variant:"ghost",onClick:e,children:(0,g.jsx)(X.A,{size:24})})}),children:(e,s)=>(0,g.jsx)(Q,{workspace_id:t,onSubmit:s})})}function se(e){let{children:t,index:s}=e;const{width:l,camera:n}=ne();return(0,g.jsx)("div",{style:{width:l,left:l*s,opacity:n===s+1?1:0},className:"absolute flex flex-grow top-0 transition-all overflow-hidden",children:t})}const le=(0,i.createContext)({slides:[],push:e=>{},back:()=>{},width:0,camera:0}),ne=()=>(0,i.useContext)(le);function ie(e){let{children:t}=e;const s=(0,i.useRef)(null),[l,n]=(0,i.useState)(0);(0,i.useEffect)((()=>{null!==s&&void 0!==s&&s.current&&n(s.current.getBoundingClientRect().width)}),[]);const[a,r]=(0,i.useState)(0),[o,d]=(0,i.useState)([]),c=e=>{d((t=>[...t,e])),setTimeout((()=>{r((e=>e+1))}),100)};return(0,i.useEffect)((()=>{0===o.length&&t&&c(t)}),[t]),(0,g.jsx)(le.Provider,{value:{width:l,camera:a,slides:o,push:c,back:()=>{d((e=>(e.pop(),e))),setTimeout((()=>{r((e=>e>0?e-1:0))}),100)}},children:(0,g.jsx)("div",{className:"relative h-full flex-grow",children:(0,g.jsx)("div",{ref:s,className:"viewport flex flex-row w-full h-full absolute top-0 left-0 transition-all",style:{transform:`translateX(${-1*(a-1)*l}px)`},children:o.map(((e,t)=>(0,g.jsx)(se,{index:t,children:e},t)))})})})}var ae=s(3209),re=s(6178),oe=s.n(re),de=s(9074),ce=s(9075),ue=s(8604);const xe=e=>{var t;const{user:s}=(0,ce.A)(),l=null===(t=null===e||void 0===e?void 0:e.hasInitFetch)||void 0===t||t,n=null===e||void 0===e?void 0:e.workspace_id,a=null===e||void 0===e?void 0:e.chat_id,r=(0,v.FO)(),{chats:o,error:c,loading:u,participants:x}=(0,d.GV)((e=>e.chat)),m=(0,d.jL)();(0,i.useEffect)((()=>{!0===l&&n&&m((0,ae._5)({workspace_id:n}))}),[n,l]),(0,v.FO)("updateMessage",(e=>console.log("data",e)));(0,v.FO)("messageSeen",(e=>{m((0,ae.v9)({chat_id:e.chat_id,nonce_id:e.nonce_id}))}));return{add:(e,t)=>{m((0,ae.tj)(e)),t&&t()},send:(e,t)=>{let{text:l,mentions:n,links:i,files:o}=e;const d=function(e){let{chat_id:t,user_id:s,text:l}=e;const n=1e3*oe()().unix();return{chat_id:t,created_at:null,deleted_at:null,files:[],is_edited:null,is_pinned:0,links:[],mentions:[],nonce_id:n,reply_to:null,seen:!1,text:l,updated_at:n,user:s,is_delivered:!1,is_rejected:!1,is_pending:!1}}({chat_id:a,user_id:null===s||void 0===s?void 0:s.id,text:l});return m((0,ae.tj)(d)),null===r||void 0===r||r.emit("sendMessage",d,(e=>{})),t&&t(),setTimeout((()=>{(0,de.J)(ue.X.scrollEndChatBox)}),1),d},update:(e,t)=>{null===r||void 0===r||r.emit("sendMessage",e,(e=>{})),m((0,ae.nc)(e)),t&&t()},seen:(e,t)=>{null===r||void 0===r||r.emit("seenMessage",{chat_id:e.chat_id,nonce_id:e.nonce_id}),m((0,ae.v9)({chat_id:e.chat_id,nonce_id:e.nonce_id})),t&&t()},chats:Object.keys(o).map((e=>o[e].object)),chatObjects:o,loading:u,error:c,participants:x}};var me=s(6561);function fe(e){let{title:t,sub_title:s,description:l}=e;return(0,g.jsxs)("div",{className:"flex flex-col gap-y-1 flex-1",children:[(0,g.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,g.jsx)("strong",{children:t}),!!s&&(0,g.jsx)("span",{className:"text-xs text-gray-500",children:s})]}),!!l&&(0,g.jsx)("span",{className:"text-sm text-gray-500",children:l})]})}let ve;function he(e){let{count:t,showAnimate:s=!0,size:l="small",className:n}=e;const[a,r]=(0,i.useState)(!1);(0,i.useEffect)((()=>(s&&(r(!0),ve=setTimeout((()=>{r(!1)}),1e3)),()=>{clearTimeout(ve)})),[t,s]);let o=null!==n&&void 0!==n?n:"";switch(l){case"small":o+=" w-[16px] h-[16px]";break;case"normal":o+=" w-[24px] h-[24px]";break;case"large":o+=" w-[32px] h-[32px]"}return t<=0?null:(0,g.jsx)("div",{className:`rounded-full bg-destructive text-white flex items-center justify-center ${a?"animate-scale-custom":""} ${o}`,children:t})}function pe(){const{chat:e}=gs(),{chats:t}=(0,d.GV)((e=>e.chat)),s=(0,i.useMemo)((()=>{var s,l;const n=null===(s=t[null===e||void 0===e?void 0:e.id])||void 0===s||null===(l=s.messages)||void 0===l?void 0:l.filter((e=>!1===e.seen));return n}),[t,null===e||void 0===e?void 0:e.id]);return(0,g.jsx)(he,{count:null===s||void 0===s?void 0:s.length,className:"absolute bottom-2 right-2",size:"normal"})}function ge(){var e,t,s,l;const{chat:n}=gs();return(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-2 w-full",children:[(0,g.jsx)(me.A,{title:null===n||void 0===n||null===(e=n.title)||void 0===e?void 0:e.slice(0,1),className:"w-12 h-12"}),(0,g.jsx)(fe,{title:null===n||void 0===n?void 0:n.title,sub_title:null!==n&&void 0!==n&&null!==(t=n.last_message)&&void 0!==t&&t.updated_at?oe()(1e3*(null===n||void 0===n||null===(s=n.last_message)||void 0===s?void 0:s.updated_at)).format("HH:mm"):void 0,description:null===n||void 0===n||null===(l=n.last_message)||void 0===l?void 0:l.text}),(0,g.jsx)(pe,{})]})}var je=s(5469);function be(e){let{onClick:t}=e;return(0,g.jsx)("div",{children:(0,g.jsx)(ee.A,{className:"text-black/60",onClick:t,children:(0,g.jsx)(je.A,{})})})}var we=s(9604);const ye=we.bL,Ne=we.l9,ke=i.forwardRef(((e,t)=>{let{className:s,align:l="center",sideOffset:n=4,...i}=e;return(0,g.jsx)(we.ZL,{children:(0,g.jsx)(we.UC,{ref:t,align:l,sideOffset:n,className:(0,f.cn)("z-[10] w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})})}));function Ae(e){let{trigger:t,children:s,open:l,contentClassName:n,triggerClassName:i="",align:a="end"}=e;return(0,g.jsxs)(ye,{open:l,children:[(0,g.jsx)(Ne,{className:`popover-trigger ${i}`,children:t}),(0,g.jsx)(ke,{align:a,className:null!==n&&void 0!==n?n:"",children:s})]})}ke.displayName=we.UC.displayName;var Ce=s(5650);const Se=Ce.Kq,_e=Ce.bL,Re=Ce.l9,Ee=i.forwardRef(((e,t)=>{let{className:s,sideOffset:l=4,...n}=e;return(0,g.jsx)(Ce.UC,{ref:t,sideOffset:l,className:(0,f.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})}));function ze(e){let{children:t,title:s,triggerClassName:l,tooltipTriggerProps:n}=e;return(0,g.jsx)(Se,{children:(0,g.jsxs)(_e,{children:[(0,g.jsx)(Re,{...n,className:null!==l&&void 0!==l?l:"",children:t}),(0,g.jsx)(Ee,{children:(0,g.jsx)("span",{children:s})})]})})}Ee.displayName=Ce.UC.displayName;var Le=s(8646),Te=s(8623);let Pe=function(e){return e[e.Video=0]="Video",e[e.Voice=1]="Voice",e[e.Text=2]="Text",e}({});var De=s(4453);function Ie(e){let{schedule:t,handleSelect:s,handleDeSelect:l,selectedDay:n}=e;const i=oe()(),a=Array.from(Array(7).keys());return(0,g.jsx)("div",{className:"flex flex-row items-center justify-center w-full gap-x-2",children:a.map((e=>{const a=t.days.find((t=>t.day===e)),r=!!a,o=i.day()===e;let d="relative flex flex-col items-center justify-center w-10 h-10 cursor-default rounded-md";d+=r?" border border-blue-500 text-blue-500 cursor-pointer bg-white hover:bg-blue-50":" grayscale opacity-[.4]";let c="";r&&(c=a.times.map((e=>`${e.start} - ${e.end}`)).join(", ")),r&&o&&n===e&&(d+=" bg-blue-50");let u=(0,g.jsxs)("div",{className:d,onMouseEnter:()=>s(e),onMouseLeave:()=>l(e),children:[(0,g.jsx)("span",{children:(0,f.Py)(e)[0]}),!!o&&(0,g.jsx)("span",{className:"absolute text-blue-500 bottom-[-12px] left-[50%] translate-x-[-50%]",children:(0,g.jsx)(De.A,{})})]});return(0,g.jsx)(g.Fragment,{children:r?(0,g.jsx)(ze,{title:c,children:u},e):u})}))})}var $e=s(5505),Me=s(9333),Oe=s(629),Ve=s(3735),Ue=s(6533),Fe=s(1479),He=s(2382),Je=s(5711),Ge=s(6210);const qe=Fe.bL,Be=Fe.YJ,Ye=Fe.WT,We=i.forwardRef(((e,t)=>{let{className:s,children:l,...n}=e;return(0,g.jsxs)(Fe.l9,{ref:t,className:(0,f.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...n,children:[l,(0,g.jsx)(Fe.In,{asChild:!0,children:(0,g.jsx)(He.A,{className:"h-4 w-4 opacity-50"})})]})}));We.displayName=Fe.l9.displayName;const Xe=i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(Fe.PP,{ref:t,className:(0,f.cn)("flex cursor-default items-center justify-center py-1",s),...l,children:(0,g.jsx)(Je.A,{className:"h-4 w-4"})})}));Xe.displayName=Fe.PP.displayName;const Ke=i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(Fe.wn,{ref:t,className:(0,f.cn)("flex cursor-default items-center justify-center py-1",s),...l,children:(0,g.jsx)(He.A,{className:"h-4 w-4"})})}));Ke.displayName=Fe.wn.displayName;const Ze=i.forwardRef(((e,t)=>{let{className:s,children:l,position:n="popper",...i}=e;return(0,g.jsx)(Fe.ZL,{children:(0,g.jsxs)(Fe.UC,{ref:t,className:(0,f.cn)("relative z-[1002] max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...i,children:[(0,g.jsx)(Xe,{}),(0,g.jsx)(Fe.LM,{className:(0,f.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,g.jsx)(Ke,{})]})})}));Ze.displayName=Fe.UC.displayName;i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(Fe.JU,{ref:t,className:(0,f.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...l})})).displayName=Fe.JU.displayName;const Qe=i.forwardRef(((e,t)=>{let{className:s,children:l,...n}=e;return(0,g.jsxs)(Fe.q7,{ref:t,className:(0,f.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,g.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,g.jsx)(Fe.VF,{children:(0,g.jsx)(Ge.A,{className:"h-4 w-4"})})}),(0,g.jsx)(Fe.p4,{children:l})]})}));Qe.displayName=Fe.q7.displayName;function et(e){let{label:t,className:s="",items:l,onChange:n,defaultValue:i}=e;return(0,g.jsxs)("div",{className:`flex flex-col gap-y-1 w-full ${s}`,children:[!!t&&(0,g.jsx)("strong",{className:"text-sm",children:t}),(0,g.jsxs)(qe,{onValueChange:n,value:i,children:[(0,g.jsx)(We,{className:"w-full",children:(0,g.jsx)(Ye,{placeholder:"Select"})}),(0,g.jsx)(Ze,{children:(0,g.jsx)(Be,{children:0===l.length?(0,g.jsx)("div",{className:"p-2 flex items-center justify-center text-xs",children:"There is nothing here"}):l.map(((e,t)=>(0,g.jsx)(Qe,{value:e.value,children:e.title},t)))})})]})]})}i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(Fe.wv,{ref:t,className:(0,f.cn)("-mx-1 my-1 h-px bg-muted",s),...l})})).displayName=Fe.wv.displayName;const tt=()=>{const e=[];for(let t=0;t<24;t++)for(let s=0;s<60;s+=30){const l=t.toString().padStart(2,"0"),n=s.toString().padStart(2,"0");e.push(`${l}:${n}`)}return e};function st(e){let{defaultValue:t,onChange:s,className:l=""}=e;const[n,a]=(0,i.useState)("08:00");(0,i.useEffect)((()=>{void 0!==t&&a(t)}),[t]);const r=(0,i.useMemo)((()=>tt()),[]),o=(0,i.useCallback)((e=>{a(e),s&&s(e)}),[s]);return(0,g.jsx)(et,{className:l,items:r.map((e=>({title:e,value:e}))),defaultValue:t||n,onChange:o})}var lt=s(6174);function nt(e){let{dayTime:t,onChange:s}=e;const[l,n]=(0,i.useState)({from:"",to:""});(0,i.useEffect)((()=>{void 0!==t&&n(t)}),[t]);const a=(0,i.useCallback)(((e,t)=>{n((l=>{const n={...l,[e]:t};return s&&s(n),n}))}),[s]);return(0,g.jsxs)("div",{className:"flex flex-row gap-x-4 items-center",children:[(0,g.jsx)(st,{defaultValue:null===l||void 0===l?void 0:l.from,onChange:e=>a("from",e)}),(0,g.jsx)("div",{children:(0,g.jsx)(lt.A,{size:12})}),(0,g.jsx)(st,{defaultValue:null===l||void 0===l?void 0:l.to,onChange:e=>a("to",e)})]})}var it=s(2073),at=s(8687);const rt=i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(at.bL,{className:(0,f.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...l,ref:t,children:(0,g.jsx)(at.zi,{className:(0,f.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})}));function ot(e){var t;let{label:s,...l}=e;const n=null!==(t=null===l||void 0===l?void 0:l.id)&&void 0!==t?t:(0,it.A)();return(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-4",children:[(0,g.jsx)(rt,{id:n,...l}),(0,g.jsx)("label",{className:"cursor-pointer text-sm",htmlFor:n,children:s})]})}rt.displayName=at.bL.displayName;var dt=s(4808);function ct(e){let{onClick:t}=e;return(0,g.jsx)(ee.A,{className:"text-black",onClick:t,children:(0,g.jsx)(X.A,{size:12})})}function ut(e){let{onClick:t}=e;return(0,g.jsx)(ee.A,{className:"text-black",onClick:t,children:(0,g.jsx)(dt.A,{size:12})})}const xt={from:"09:00",to:"16:00"};function mt(e){let{day:t,onChange:s,index:l}=e;const[n,a]=(0,i.useState)({index:0,times:[xt],availability_type:Pe.Voice,selected:!1});(0,i.useEffect)((()=>{void 0!==t&&a(t)}),[t]);const r=(0,i.useCallback)((()=>{a((e=>{var t;const l={...e,times:[...null!==(t=null===e||void 0===e?void 0:e.times)&&void 0!==t?t:[],xt]};return s&&s(l),l}))}),[s]),o=(0,i.useCallback)((e=>{a((t=>{const l={...t,times:t.times.filter(((t,s)=>e!==s))};return s&&s(l),l}))}),[s]);return(0,g.jsxs)("div",{className:"flex flex-row items-start gap-x-2",children:[(0,g.jsx)("div",{className:"min-w-[200px] mt-2",children:(0,g.jsx)(ot,{label:(0,f.Py)(l),checked:n.selected,onCheckedChange:e=>{a((t=>{const l={...t,selected:e};return s&&s(l),l}))}})}),(0,g.jsx)("div",{className:"flex flex-col gap-y-4 w-full",children:null===n||void 0===n?void 0:n.times.map(((e,t)=>(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-2",children:[(0,g.jsx)(nt,{dayTime:e,onChange:e=>((e,t)=>{a((l=>(l.times[e]=t,s&&s(l),l)))})(t,e)}),0===t?(0,g.jsx)(ct,{onClick:r}):(0,g.jsx)(ut,{onClick:()=>o(t)})]},t)))})]})}var ft=s(8693);function vt(e){let{title:t,children:s,className:l}=e;return(0,g.jsxs)("div",{className:`flex flex-col gap-y-2 ${l}`,children:[(0,g.jsx)("strong",{children:t}),s]})}function ht(e){let{item:t,isChecked:s,onSelect:l}=e;return(0,g.jsx)(L.A,{onClick:()=>l(t.value),variant:s?"default":"outline",className:"min-w-[80px]",startIcon:t.icon,children:t.title})}function pt(e){let{items:t,defaultSelected:s,onChange:l,isSingular:n}=e;const[a,r]=(0,i.useState)([]);(0,i.useEffect)((()=>{void 0!==s&&r(s)}),[s]);const o=e=>{let t=[];if(n)return t=[e],r(t),void(l&&l(t));t=a.includes(e)?a.filter((t=>t!==e)):[...a,e],l&&l(t),r(t)};return 0===t.length?null:(0,g.jsx)("div",{className:"flex flex-row items-center gap-2 flex-wrap",children:t.map((e=>(0,g.jsx)(ht,{item:e,isChecked:a.includes(e.value),onSelect:o},e.value)))})}function gt(e){let{value:t,onChange:s}=e;return(0,g.jsx)(pt,{items:[{title:"Video",value:Pe.Video,icon:(0,g.jsx)(Me.A,{size:16})},{title:"Voice",value:Pe.Voice,icon:(0,g.jsx)(Oe.A,{size:16})},{title:"Text",value:Pe.Text,icon:(0,g.jsx)($e.A,{size:16})}],onChange:e=>s&&s(+e[0]),defaultSelected:void 0!==t?[t]:[],isSingular:!0})}function jt(e){let{eventId:t,onDelete:s}=e;const{startLoading:l,stopLoading:n,isLoading:i}=a();return(0,g.jsx)(L.A,{onClick:()=>{l(),h.A.delete(`/schedules/${t}`).then((e=>{K.oR.success("Event has been deleted"),s&&s(),n()})).catch((()=>{n()}))},startIcon:(0,g.jsx)(dt.A,{size:16}),className:"min-w-[160px] !border-red-500 !text-red-500",variant:"outline",loading:i,children:"Delete event"})}var bt=s(9463),wt=s(8326),yt=s(7307),Nt=s(9772);function kt(e){let{className:t,classNames:s,showOutsideDays:l=!0,...n}=e;return(0,g.jsx)(yt.hv,{showOutsideDays:l,className:(0,f.cn)("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,f.cn)((0,Nt.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,f.cn)((0,Nt.r)({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...s},components:{IconLeft:e=>{let{...t}=e;return(0,g.jsx)(bt.A,{className:"h-4 w-4"})},IconRight:e=>{let{...t}=e;return(0,g.jsx)(wt.A,{className:"h-4 w-4"})}},...n})}function At(e){let{onChange:t,defaultDate:s,format:l="YYYY-MM-DD",className:n="",inputProps:a}=e;const[r,o]=(0,i.useState)();(0,i.useEffect)((()=>{void 0!==s&&o(s)}),[s]);const d=(0,i.useMemo)((()=>void 0===r?"":oe()(r).format(l)),[r]);return(0,g.jsx)(Ae,{triggerClassName:n,trigger:(0,g.jsx)(Y.A,{...a,value:d}),children:(0,g.jsx)(kt,{selected:r,onDayClick:e=>{o(e),t&&t(e)}})})}function Ct(e){let{onClose:t,defaultId:s,defaultValue:l,onDelete:n,onCreated:r}=e;const{workspace_id:o}=b(),d=void 0!==l&&void 0!==s,[c,u]=(0,i.useState)(),[x,m]=(0,i.useState)(!1),[f,v]=(0,i.useState)(Pe.Voice),[p,j]=(0,i.useState)();(0,i.useEffect)((()=>{if(void 0!==l){var e;const{availability_type:t,days:s}=l;v(t),j(s),m(null!==(e=null===l||void 0===l?void 0:l.is_recurrence)&&void 0!==e&&e),null!==l&&void 0!==l&&l.recurrence_end&&u((e=>({...e,ends_at:null===l||void 0===l?void 0:l.recurrence_end}))),null!==l&&void 0!==l&&l.recurrence_start&&u((e=>({...e,start_at:null===l||void 0===l?void 0:l.recurrence_start})))}}),[l]);const w=Array.from(Array(7).keys());(0,i.useEffect)((()=>{}),[p]);const{startLoading:y,stopLoading:N,isLoading:k}=a();return(0,g.jsxs)("div",{className:"flex flex-col gap-y-8",children:[(0,g.jsx)(vt,{title:"Availability Type",children:(0,g.jsx)(gt,{value:f,onChange:v})}),(0,g.jsx)(vt,{title:"Days",children:(0,g.jsx)("div",{className:"flex flex-col gap-y-6",children:w.map(((e,t)=>{const s=null===p||void 0===p?void 0:p[e];return(0,g.jsxs)("div",{className:"day",children:[(0,g.jsx)(mt,{index:t,day:s,onChange:e=>((e,t)=>{j((s=>{const l=void 0!==s?s:{};return l[e]=t,l}))})(t,e)}),(0,g.jsx)("hr",{className:"mt-6"})]},t)}))})}),(0,g.jsxs)(vt,{title:"Times",className:"flex flex-col gap-y-4",children:[(0,g.jsx)(ot,{label:"Is this event recurrence?",checked:x,onCheckedChange:m}),x&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(At,{inputProps:{label:"Start at"},defaultDate:null!==c&&void 0!==c&&c.start_at?oe()(c.start_at).toDate():void 0,onChange:e=>u((t=>({...t,start_at:oe()(e).format("YYYY-MM-DD HH:mm:ss")})))}),(0,g.jsx)(At,{inputProps:{label:"Ends at"},defaultDate:null!==c&&void 0!==c&&c.ends_at?oe()(c.ends_at).toDate():void 0,onChange:e=>u((t=>({...t,ends_at:oe()(e).format("YYYY-MM-DD HH:mm:ss")})))})]})]}),(0,g.jsxs)("div",{className:"flex flex-row justify-end gap-x-2",children:[(0,g.jsx)(L.A,{variant:"outline",className:"min-w-[120px]",onClick:t,children:"Close"}),d&&(0,g.jsx)(jt,{eventId:s,onDelete:()=>n&&n()}),(0,g.jsx)(L.A,{onClick:()=>{const e=Intl.DateTimeFormat().resolvedOptions().timeZone;if(void 0===p)return;y();let t={is_recurrence:x,timezone:e,availability_type:f,workspace_id:o};x&&(null!==c&&void 0!==c&&c.start_at&&(t.recurrence_start_at=null===c||void 0===c?void 0:c.start_at),null!==c&&void 0!==c&&c.ends_at&&(t.recurrence_end_at=null===c||void 0===c?void 0:c.ends_at));const l=Object.keys(p).map((e=>({day:p[+e],dayIndex:e}))).filter((e=>e.day.selected)).map((e=>({day:+e.dayIndex,times:e.day.times.map((e=>({start:e.from,end:e.to})))})));t.days=l,(0,h.A)({url:d?`/schedules/${s}`:"/schedules",method:d?"PUT":"POST",data:t}).then((e=>{K.oR.success(d?"Event has been updated":"Event has been created"),d||r&&r(),N()})).catch((()=>{N()}))},startIcon:(0,g.jsx)(ft.A,{size:16}),className:"min-w-[160px]",loading:k,disabled:void 0===p,children:(d?"Update":"Create")+" Event"})]})]})}function St(e){let{schedule:t,onDelete:s}=e;const l=(0,i.useMemo)((()=>{var e,s;const l={};for(let a of t.days){var n,i;l[a.day]={availability_type:t.availability_type,index:a.day,selected:!0,times:null!==(n=null===a||void 0===a||null===(i=a.times)||void 0===i?void 0:i.map((e=>({from:e.start,to:e.end}))))&&void 0!==n?n:[]}}return{availability_type:t.availability_type,days:l,is_recurrence:1===t.is_recurrence,recurrence_start:null!==(e=t.recurrence_start_at)&&void 0!==e?e:void 0,recurrence_end:null!==(s=t.recurrence_end_at)&&void 0!==s?s:void 0}}),[t]);return(0,g.jsx)(B,{trigger:e=>(0,g.jsx)(ze,{title:"Edit schedule",children:(0,g.jsx)(ee.A,{onClick:e,className:"text-black/60 hover:text-black w-8 h-8",children:(0,g.jsx)(Ue.A,{size:12})})}),className:"w-[640px]",children:(e,n)=>(0,g.jsx)(Ct,{onClose:n,defaultId:t.id,defaultValue:l,onDelete:()=>{s&&s(),n()}})})}function _t(e){let{selectedDay:t,item:s}=e;const l=s.days.filter((e=>e.day===t)),n=(0,i.useMemo)((()=>{let e=`${(0,f.Py)(t)}`;if(l.length>0){e+=" : ";for(let t of l){let s=0;for(let l of t.times)e+=` ${l.start} - ${l.end}`,s<t.times.length-1&&(e+=", "),s++}}return e}),[t,l,s]);return 0===l.length?null:(0,g.jsx)("div",{className:"flex flex-row items-center text-xs",children:n})}kt.displayName="Calendar";let Rt={[Pe.Text]:(0,g.jsx)($e.A,{size:12}),[Pe.Video]:(0,g.jsx)(Me.A,{size:12}),[Pe.Voice]:(0,g.jsx)(Oe.A,{size:12})};function Et(e){let{schedule:t,onDelete:s,justView:l}=e;const n=oe()().day(),[a,r]=(0,i.useState)(),o=(0,i.useCallback)((e=>r(e)),[]),d=(0,i.useCallback)((e=>r(n)),[n]);return(0,i.useEffect)((()=>{for(let e of t.days)if(n===e.day){r(n);break}}),[t,n]),(0,g.jsxs)("div",{className:"flex flex-col gap-y-4 items-start w-full p-4 border rounded-md shadow-md",children:[(0,g.jsxs)("div",{className:"flex flex-row justify-between items-center w-full",children:[(0,g.jsx)(ze,{title:`Available with ${Pe[t.availability_type]}`,children:(0,g.jsxs)("strong",{className:"italic text-xs text-black/60 flex flex-row items-center gap-x-1",children:[`${t.timezone}`,Rt[t.availability_type]]})}),(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-2",children:[!l&&(0,g.jsx)(St,{schedule:t,onDelete:s}),!!t.is_recurrence&&(0,g.jsx)(ze,{title:"Recurrence",children:(0,g.jsx)(Ve.A,{size:12,className:"text-black/60"})})]})]}),(0,g.jsx)(Ie,{schedule:t,handleDeSelect:d,handleSelect:o,selectedDay:a}),(0,g.jsx)("div",{className:"min-h-[24px]",children:void 0!==a&&(0,g.jsx)(_t,{item:t,selectedDay:a})})]})}var zt=s(3574);function Lt(e){let{items:t,onDelete:s,justView:l=!0}=e;return 0===t.length?(0,g.jsx)(zt.A,{title:"There is no schedule for this user yet!",className:"py-6"}):(0,g.jsx)("div",{className:"mb-6 flex flex-col gap-y-2",children:t.map((e=>(0,g.jsx)(Et,{schedule:e,onDelete:s,justView:l},e.id)))})}var Tt=s(3765);function Pt(e){let{title:t,children:s,onClose:l,className:n}=e;return(0,g.jsxs)("div",{className:`flex flex-col gap-y-2 ${null!==n&&void 0!==n?n:""}`,children:[(0,g.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,g.jsx)("strong",{children:t}),!!l&&(0,g.jsx)(ee.A,{onClick:l,className:"text-yellow-600 !w-[14px] !h-[14px] !px-1",children:(0,g.jsx)(Tt.A,{size:14})})]}),(0,g.jsx)("hr",{}),(0,g.jsx)("div",{children:s})]})}function Dt(e){var t;let{justView:s=!0}=e;const{user:l}=qt(),{data:a,isLoading:r}=(0,n.g)(`/users/${null===l||void 0===l?void 0:l.id}/schedules`),o=void 0!==a?null===a||void 0===a?void 0:a.data:[],d=(0,i.useMemo)((()=>(0,f.bQ)(o)),[o]);return void 0===a||r?(0,g.jsx)(Te.A,{}):(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(Pt,{title:`${(0,f.kR)(null!==(t=null===l||void 0===l?void 0:l.username)&&void 0!==t?t:"")}'s schedules (${d}h) per week`,onClose:()=>{},children:(0,g.jsx)(Lt,{items:o,justView:s})})})}function It(){const{user:e}=qt();let t=null===e||void 0===e?void 0:e.name;t||(t=null===e||void 0===e?void 0:e.username),t&&(t=(0,f.kR)(t));const s=`${t}'s schedules`;return(0,g.jsx)(q,{hasClose:!1,trigger:e=>(0,g.jsx)(ze,{title:s,children:(0,g.jsx)(ee.A,{onClick:e,size:"icon",className:"text-black w-6 h-6",children:(0,g.jsx)(Le.A,{size:16})})}),className:"w-[424px]",children:(e,t)=>(0,g.jsx)(Dt,{justView:!0})})}var $t=s(8223);function Mt(){return(0,g.jsx)(ze,{title:"Happy!",children:(0,g.jsx)($t.A,{size:16})})}var Ot=s(3817),Vt=s(530),Ut=s(3329);const Ft=e=>{const t=(0,v.FO)(),{user:s}=qt(),{user:l}=(0,ce.A)(),{room:n}=b(),a=(0,Vt.VH)(),r=a.getNodes(),o=(0,i.useCallback)((()=>{var e,i,o,d,c,u,x,m,f,v;if(!s||!t||!l)return;const h=r.find((e=>e.id===s.username)),p=r.find((e=>e.type===Ut.c.jailNodeType)),g=r.find((e=>e.type===Ut.c.backgroundNodeType)),j=1.5*((null!==(e=null===g||void 0===g||null===(i=g.measured)||void 0===i?void 0:i.width)&&void 0!==e?e:0)-(null!==(o=null===p||void 0===p||null===(d=p.measured)||void 0===d?void 0:d.width)&&void 0!==o?o:0)),b=((null!==(c=null===g||void 0===g||null===(u=g.measured)||void 0===u?void 0:u.height)&&void 0!==c?c:0)-(null!==(x=null===p||void 0===p||null===(m=p.measured)||void 0===m?void 0:m.height)&&void 0!==x?x:0))/1.5,w=null===h||void 0===h||null===(f=h.measured)||void 0===f?void 0:f.height,y=null===h||void 0===h||null===(v=h.measured)||void 0===v?void 0:v.width,N=null===h||void 0===h?void 0:h.position.x,k=null===h||void 0===h?void 0:h.position.y;if(w&&y&&N&&k){const e=y/2,s=N+e,i=k+e,r=1.5;a.setCenter(s-j,i-b,{zoom:r,duration:1e3});const{x:o,y:d}=((e,t)=>{const s=2*Math.random()*Math.PI,l=e+t,n=Math.cos(s),i=Math.sin(s);let a=l*n,r=l*i;return n<0?a-=t:a+=t,i<0?r-=t:r+=t,{x:a,y:r}})(e,Ut.c.teleportMargin);const c=`${N+o},${k+d}`,u={room_id:null===n||void 0===n?void 0:n.id,coordinates:c,username:l.username};t.emit("updateCoordinates",u),(0,de.J)({type:ue.X.changeMyUserCoord,data:{...l,coordinates:c}})}}),[s,r,null===l||void 0===l?void 0:l.username]);return(0,g.jsx)(ze,{title:"User navigate",children:(0,g.jsx)(ee.A,{onClick:o,size:"icon",className:"text-black w-6 h-6",children:(0,g.jsx)(Ot.A,{size:16})})})};function Ht(){var e;const{user:t,roomId:s}=qt(),{user:l}=(0,ce.A)(),{room_id:n}=b(),i=s===n,a=(null===l||void 0===l?void 0:l.id)===(null===t||void 0===t?void 0:t.id);return(0,g.jsxs)("div",{className:"relative pb-[40px]",children:[(0,g.jsx)("div",{className:"h-[80px] bg-black/70 w-full"}),(0,g.jsx)(me.A,{src:null===t||void 0===t||null===(e=t.avatar)||void 0===e?void 0:e.url,className:"absolute w-[80px] h-[80px] bottom-0 left-4 border-4 border-white"}),(0,g.jsxs)("div",{className:"absolute bottom-2 right-2 flex flex-row items-center gap-x-2",children:[i&&!a&&(0,g.jsx)(Ft,{}),(0,g.jsx)(Mt,{}),(0,g.jsx)(It,{})]})]})}function Jt(){const{user:e}=qt(),t=oe()();return(0,g.jsx)("span",{className:"text-[8px] font-light text-black/50",children:`Since ${t.format("YYYY")}`})}const Gt=(0,i.createContext)({user:void 0,roomId:void 0}),qt=()=>(0,i.useContext)(Gt);function Bt(e){let{user:t,roomId:s}=e;return(0,g.jsx)(Gt.Provider,{value:{user:t,roomId:s},children:(0,g.jsxs)("div",{className:"w-full max-w-full flex flex-col select-none",children:[(0,g.jsx)(Ht,{}),(0,g.jsx)("div",{className:"p-4 pt-0 flex flex-col gap-y-2",children:(0,g.jsxs)("div",{className:"flex flex-col",children:[(0,g.jsx)("strong",{"data-testid":"username-detail-card",className:"capitalize",children:t.name}),(0,g.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,g.jsx)("span",{className:"text-xs font-light",children:t.username}),(0,g.jsx)(Jt,{})]})]})})]})})}function Yt(e){let{user:t,roomId:s,children:l}=e;return(0,g.jsx)(Ae,{trigger:l,contentClassName:"p-0 overflow-hidden border-0 m-0 shadow-md",children:(0,g.jsx)(Bt,{roomId:s,user:t})})}function Wt(e){var t,s,l;let{chat:n}=e;const{getUser:i}=es(),a=i(n.user);return a?(0,g.jsx)(Yt,{user:a,children:(0,g.jsx)(me.A,{className:"w-9 h-9",src:null===a||void 0===a||null===(t=a.avatar)||void 0===t?void 0:t.url,title:null!==(s=null===(l=(0,f.kR)(a.username))||void 0===l?void 0:l[0])&&void 0!==s?s:""})}):null}function Xt(e){let{chat:t}=e;return(0,g.jsx)("div",{className:"felx flex-col items-end w-full text-right",children:(0,g.jsx)("span",{className:"text-xs text-black/60",children:oe()(t.nonce_id).format("HH:mm")})})}var Kt=s(1149);function Zt(e){let{chat:t}=e;const{user:s}=(0,ce.A)(),{getUser:l}=es(),n=l(t.user),i=(null===s||void 0===s?void 0:s.id)===(null===n||void 0===n?void 0:n.id),a=(e,t,s)=>{let l="text-blue-600 whitespace-pre-wrap";"link"===s&&(l+=" hover:underline");let n=t;return(0,g.jsx)("a",{className:l,style:{overflowWrap:"break-word"},target:"link"===s?"_blank":"_self",...e,children:n})};return(0,g.jsxs)("div",{className:"flex flex-1 flex-col bg-black/5 rounded-xl rounded-bl-none p-2 max-w-full w-full",children:[!i&&(0,g.jsx)("strong",{children:null===n||void 0===n?void 0:n.name}),(0,g.jsx)("p",{className:"text-wrap mb-3 w-full",dir:"auto",style:{overflowWrap:"break-word",wordBreak:"break-word",whiteSpace:"normal"},children:t.text.split("\n").map(((e,t)=>(0,g.jsx)(Kt.A,{options:{nl2br:!0,render:{url:e=>{let{attributes:t,content:s}=e;return a(t,s,"link")},mention:e=>{let{attributes:t,content:s}=e;return a(t,s,"mention")}},formatHref:{mention:()=>"#"}},children:(0,g.jsxs)("span",{children:[e,(0,g.jsx)("br",{})]},t)})))}),(0,g.jsx)(Xt,{chat:t})]})}const Qt=(0,i.createContext)({getUser:e=>{}}),es=()=>(0,i.useContext)(Qt);function ts(e){let{item:t,getUser:s,isMine:l}=e;const{seen:n}=xe(),a=(0,i.useRef)(null),[r,o]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{const e=new IntersectionObserver((e=>{let[t]=e;o(t.isIntersecting)}),{threshold:.5});return a.current&&e.observe(a.current),()=>{a.current&&e.unobserve(a.current)}}),[]),(0,i.useEffect)((()=>{r&&!1===(null===t||void 0===t?void 0:t.seen)&&0!==t.nonce_id&&!l&&n(t)}),[t,r,l,n]),(0,g.jsx)(Qt.Provider,{value:{getUser:s},children:(0,g.jsxs)("div",{ref:a,className:"message-item p-2 flex flex-row items-end gap-x-2",children:[(0,g.jsx)(Wt,{chat:t}),(0,g.jsx)(Zt,{chat:t})]})})}var ss=s(5262);function ls(){return(0,g.jsx)("div",{className:"absolute top-0 flex items-center justify-center right-0 left-0",children:(0,g.jsx)(Te.A,{})})}function ns(e){var t;let{items:s}=e;const l=(0,d.jL)(),n=null===s||void 0===s||null===(t=s[0])||void 0===t?void 0:t.chat_id,i=s.filter((e=>!1===e.seen)).length;return 0===i?null:(0,g.jsxs)(ee.A,{onClick:()=>{n&&(l((0,ae.po)({chat_id:n})),(0,de.J)(ue.X.scrollEndChatBox))},className:"absolute bottom-4 right-4",children:[(0,g.jsx)(he,{size:"large",count:i,className:"absolute top-[-28px] left-[50%] translate-x-[-50%]"}),(0,g.jsx)(He.A,{className:"text-black/60"})]})}function is(e){let{items:t,marginFetching:s=1e3,onFetchNewMessages:l,getUser:n,onGetVirtualizer:a}=e;const{user:r}=(0,ce.A)(),o=(0,i.useRef)(!0),d=(0,i.useRef)(null),c=(0,i.useRef)(),[u,x]=(0,i.useState)(!1),m=[...t].reverse(),f=(0,ss.Te)({count:m.length,getScrollElement:()=>d.current,estimateSize:()=>100,measureElement:e=>e.getBoundingClientRect().height});return(0,de.A)(ue.X.scrollEndChatBox,(()=>{0!==t.length&&f.scrollToIndex(t.length,{align:"end",behavior:"smooth"})}),[t.length,f]),(0,i.useEffect)((()=>{f&&a&&a(f)}),[a,f]),(0,i.useEffect)((()=>{!1!==o.current&&0!==t.length&&(f.scrollToIndex(t.length,{align:"end"}),o.current=!1)}),[t.length,f]),(0,i.useEffect)((()=>{const e=async()=>{var e;if(((null===(e=d.current)||void 0===e?void 0:e.scrollTop)||0)<=s&&!u&&l){x(!0);try{c.current=t[t.length-1],await l()}finally{setTimeout((()=>{x(!1)}),2e3)}}},n=d.current;return n&&n.addEventListener("scroll",e),()=>{n&&n.removeEventListener("scroll",e)}}),[l,u,s,f]),(0,i.useEffect)((()=>{if(!c.current)return;const e=t.findIndex((e=>{var t;return e.id===(null===(t=c.current)||void 0===t?void 0:t.id)}));-1!==e&&(f.scrollToIndex(t.length-(e+1),{align:"start"}),x(!1))}),[t.length,f]),(0,g.jsxs)("div",{className:"flex-grow relative",children:[(0,g.jsxs)("div",{ref:d,className:"relative flex-grow overflow-y-auto mb-4 space-y-2",style:{contain:"strict",height:"100%"},children:[!!u&&(0,g.jsx)(ls,{}),(0,g.jsx)("div",{style:{height:`${f.getTotalSize()}px`,position:"relative"},children:f.getVirtualItems().map((e=>{const t=m[e.index];return(0,g.jsx)("div",{"data-index":e.index,ref:f.measureElement,style:{position:"absolute",top:`${e.start}px`,left:0,width:"100%"},children:(0,g.jsx)(ts,{item:t,getUser:n,isMine:(null===t||void 0===t?void 0:t.user)===(null===r||void 0===r?void 0:r.id)},t.nonce_id)},t.id)}))})]}),(0,g.jsx)(ns,{items:t})]})}var as=s(7922),rs=s(4258);function os(e){let{onPick:t}=e;return(0,g.jsx)(Ae,{align:"end",trigger:(0,g.jsx)(ee.A,{type:"button",className:"text-black/60",children:(0,g.jsx)(as.A,{})}),contentClassName:"!p-0 !border-0",children:(0,g.jsx)(rs.Ay,{onEmojiClick:e=>t(e.emoji)})})}function ds(){return(0,g.jsx)(ee.A,{type:"button",className:"text-black/60",children:(0,g.jsx)(Oe.A,{})})}var cs=s(4915);function us(){return(0,g.jsx)(ee.A,{type:"submit",className:"text-black/80",children:(0,g.jsx)(cs.A,{})})}function xs(e){let{text:t}=e,s=(0,g.jsx)(ds,{});return t&&(s=(0,g.jsx)(us,{})),(0,g.jsx)(g.Fragment,{children:s})}const ms=e=>{let{defaultValue:t,onChange:s,onSend:l}=e;const[n,a]=(0,i.useState)("");(0,i.useEffect)((()=>{void 0!==t&&a(t)}),[t]);const r=(0,i.useRef)(null);(0,i.useEffect)((()=>{r.current&&(r.current.style.height="auto",r.current.style.height=`${r.current.scrollHeight}px`)}),[n]);return(0,g.jsx)("textarea",{ref:r,value:n,onChange:e=>{const t=e.target.value;a(t),s(t)},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),l&&l(n),a(""))},placeholder:"Type your message here...",rows:1,className:"outline-none w-full min-h-[32px] overflow-y-auto max-h-[200px] text-sm",style:{resize:"none"}})},fs=e=>{let{addMessage:t}=e;const[s,l]=(0,i.useState)(""),n=(0,i.useCallback)((e=>{l(""),t(e.trim())}),[]),a=(0,i.useCallback)((e=>l((t=>`${t}${e}`))),[]);return(0,g.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s.trim()&&n(s.trim())},className:"flex items-end space-x-2 border border-black/10 rounded-lg p-2 bg-white",children:[(0,g.jsx)(ms,{defaultValue:s,onChange:l,onSend:n}),(0,g.jsxs)("div",{className:"flex flex-row items-center",children:[(0,g.jsx)(os,{onPick:a}),(0,g.jsx)(xs,{text:s})]})]})},vs=e=>{let{items:t=[],addMessage:s,onFetchNewMessages:l,getUser:n,onGetVirtualizer:i}=e;return(0,g.jsxs)("div",{className:"flex flex-col h-full bg-black/[.04] p-4",children:[(0,g.jsx)(is,{items:t,onFetchNewMessages:l,marginFetching:300,getUser:n,onGetVirtualizer:i}),void 0!==s&&(0,g.jsx)(fs,{addMessage:s})]})};function hs(e){var t,s;let{chat:l,onBack:n,getUser:a}=e;const r=(0,i.useRef)(),{chatObjects:o,send:c,seen:u}=xe({chat_id:l.id}),x=null!==(t=null===o||void 0===o||null===(s=o[l.id])||void 0===s?void 0:s.messages)&&void 0!==t?t:[],m=(0,i.useCallback)((e=>{const t=c({text:e});u(t)}),[u,c]),f=(0,d.jL)();(0,i.useEffect)((()=>{f((0,ae.Zm)({chat_id:l.id}))}),[null===l||void 0===l?void 0:l.id]);const{loading:v}=xe();return v?(0,g.jsx)(Te.A,{}):(0,g.jsxs)("div",{className:"flex flex-col gap-y-2 w-full h-[calc(100vh-132px)]",children:[(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-2",children:[(0,g.jsx)(be,{onClick:n}),(0,g.jsx)(fe,{title:l.title})]}),(0,g.jsx)(vs,{items:x,addMessage:m,getUser:a,onGetVirtualizer:e=>r.current=e})]})}const ps=(0,i.createContext)({chat:void 0}),gs=()=>(0,i.useContext)(ps);function js(e){let{chat:t,getUser:s}=e;const{push:l,back:n}=ne();return(0,g.jsx)(ps.Provider,{value:{chat:t},children:(0,g.jsx)("div",{className:"flex flex-row items-center gap-x-4 p-3 hover:bg-black/[.02] cursor-pointer relative",onClick:()=>l((0,g.jsx)(hs,{onBack:n,chat:t,getUser:s})),children:(0,g.jsx)(ge,{})})})}function bs(){const{workspace_id:e}=b(),{chats:t,loading:s,participants:l}=xe({workspace_id:e}),n=(0,i.useCallback)((e=>{const t=l.find((t=>t.id===e));return t}),[l]),a=(0,i.useMemo)((()=>t.sort(((e,t)=>{var s,l;return(null===t||void 0===t||null===(s=t.last_message)||void 0===s?void 0:s.nonce_id)-(null===e||void 0===e||null===(l=e.last_message)||void 0===l?void 0:l.nonce_id)}))),[t]);let r=(0,g.jsx)("div",{className:"w-full chats-holder flex flex-col gap-y-0",children:a.map((e=>(0,g.jsx)(js,{getUser:n,chat:e},null===e||void 0===e?void 0:e.id)))});return s&&(r=(0,g.jsx)(Te.A,{})),r}function ws(e){let{workspace_id:t}=e;const{add:s,update:l}=xe({workspace_id:t});(0,v.FO)("messageReceived",(e=>{s({...e,seen:!1})})),(0,v.FO)("messageUpdated",(e=>{l(e)}));let n=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(te,{workspace_id:t}),(0,g.jsx)(ie,{children:(0,g.jsx)(bs,{})})]});return(0,g.jsx)("div",{className:"flex flex-col gap-y-2",children:n})}function ys(){const{workspace_id:e}=b();return e?(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(ws,{workspace_id:+e})}):null}function Ns(e){let{title:t,toolTipTitle:s,src:l,className:n="",wrapper:i}=e,a=(0,g.jsx)(ze,{title:s||t,triggerClassName:"flex",children:(0,g.jsx)(me.A,{className:`min-w-8 min-h-8 ${n}`,src:l,title:t?null===t||void 0===t?void 0:t[0]:void 0})});return i?(0,g.jsx)(i,{children:a}):a}function ks(e){let{items:t,render:s}=e;return(0,g.jsx)("div",{className:"flex flex-row gap-1 items-start flex-wrap",children:t.map(((e,t)=>{let l=(0,i.createElement)(Ns,{...e,key:t});return s?s(e,l):l}))})}function As(e){let{participants:t,customTitle:s,render:l,avatarClss:n,className:i}=e;return 0===t.length?null:(0,g.jsx)("div",{className:`pb-4 ${null!==i&&void 0!==i?i:""}`,children:(0,g.jsx)(ks,{items:t.map((e=>{var t,i;return{id:null===e||void 0===e?void 0:e.id,src:null===e||void 0===e||null===(t=e.avatar)||void 0===t?void 0:t.url,title:null!==(i=null===e||void 0===e?void 0:e.name)&&void 0!==i?i:"",toolTipTitle:void 0!==s?s(e):void 0,className:n,render:l}})),render:l})})}function Cs(e){const{participants:t,roomId:s,...l}=e;return(0,g.jsx)(As,{render:(e,l)=>{const n=t.find((t=>e.id===t.id));return void 0===n?l:(0,g.jsx)(Yt,{roomId:s,user:n,children:l})},participants:t,...l})}function Ss(){const{leaderboard:e,workspace_id:t,usersHaveInProgressJobs:s}=b(),l=s.map((e=>e.id)),n=e.filter((e=>1===e.user.active&&null!==e.user.room_id&&e.user.workspace_id===+t&&!l.includes(e.user.id))),i=n.length;return(0,g.jsx)(vt,{title:`Online (${i})`,children:(0,g.jsx)(Cs,{className:"!pb-0",participants:n.map((e=>e.user))})})}var _s=s(8090);function Rs(e){let{user:t}=e;const{workspaceJobs:s}=b(),l=(0,i.useMemo)((()=>{let e=[];for(let n of s){var l;const s=(null!==(l=n.members)&&void 0!==l?l:[]).map((e=>e.id));s.includes(t.id)&&e.push(n)}return e.filter((e=>"in_progress"===e.status))}),[s]);return(0,g.jsxs)("div",{className:"flex flex-row gap-x-2 items-center",children:[(0,g.jsx)(Cs,{className:"!pb-0",participants:[t]}),(0,g.jsx)("span",{className:"text-sm capitalize",children:l.length>0&&l.map((e=>`${e.title} (${e.total_hours})`)).join(", ")})]})}function Es(){const{workingUsers:e}=b();return(0,g.jsx)(vt,{title:`Working (${e.length}) ${_s.Jt("sunglasses")}`,children:(0,g.jsx)("div",{className:"flex flex-col gap-y-2",children:e.map((e=>(0,g.jsx)(Rs,{user:e},e.id)))})})}function zs(){const{workpaceUsers:e,leaderboard:t,room_id:s}=b(),l=null===t||void 0===t?void 0:t.filter((e=>"online"===e.user.status&&null!==e.user.room_id)).map((e=>e.user.id)),n=e.filter((e=>!l.includes(e.id))).filter((e=>null!==e.last_login)).sort(((e,t)=>oe()(t.last_login).unix()-oe()(e.last_login).unix()));return(0,g.jsx)(vt,{title:`Offline (${n.length}) ${_s.Jt("zzz")}`,children:(0,g.jsx)(Cs,{roomId:s,avatarClss:"grayscale opacity-80 hover:grayscale-0 hover:opacity-100",participants:n.map((e=>e)),customTitle:e=>{const t=oe()(e.last_login).fromNow();return`${e.name} (${t})`}})})}function Ls(e){let{time:t,onHide:s}=e;const[l,n]=(0,i.useState)(!0),a=(0,f.UR)(t.start),r=(0,f.UR)(t.end);return(0,i.useEffect)((()=>{const e=oe()();e.diff(a,"minutes")>0&&e.diff(r,"minutes")<0||(n(!1),s&&s())}),[a,r,s]),l?(0,g.jsx)("span",{className:"text-sm text-black/60",children:`${t.start} - ${t.end}`}):null}function Ts(e){let{times:t,onHide:s}=e;return 0===t.length?null:(0,g.jsx)(g.Fragment,{children:t.map(((e,t)=>(0,g.jsx)(Ls,{time:e,onHide:s},t)))})}function Ps(e){let{schedule:t,onHide:s}=e;const[l,n]=(0,i.useState)(!1),a=(0,i.useCallback)((()=>{n(!0),s&&s()}),[s]),r=oe()(),o=(0,i.useMemo)((()=>{const e=t.days.find((e=>e.day===r.day()));if(e)return e}),[t,r.day()]);if(void 0===o)return null;let d={[Pe.Text]:(0,g.jsx)($e.A,{size:12}),[Pe.Video]:(0,g.jsx)(Me.A,{size:12}),[Pe.Voice]:(0,g.jsx)(Oe.A,{size:12})};return l?null:(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-2 select-none",children:[(0,g.jsx)(Cs,{className:"!pb-0",participants:[t.user]}),(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-1",children:[(0,g.jsx)("span",{className:"text-xs",children:d[t.availability_type]}),(0,g.jsx)(Ts,{times:o.times,onHide:a})]})]})}function Ds(e){let{schedules:t}=e;const[s,l]=(0,i.useState)([]);(0,i.useEffect)((()=>{void 0!==t&&l(t)}),[t]);return 0===s.length?null:(0,g.jsx)(vt,{title:`Scheduled (${s.length}) ${_s.Jt("scream")}`,children:(0,g.jsx)("div",{className:"flex flex-col gap-y-2",children:s.map((e=>(0,g.jsx)(Ps,{schedule:e,onHide:()=>{return t=e,void l((e=>e.filter((e=>e.id!==t.id))));var t}},e.id)))})})}function Is(){const e=oe()(),{scheduled:t,workingUsers:s,onlineUsers:l}=b(),n=l.map((e=>e.id)),i=t.filter((t=>t.days.find((t=>t.day===e.day())))).filter((e=>!n.includes(e.user.id)));return(0,g.jsx)(Ds,{schedules:i})}function $s(){return(0,g.jsxs)("div",{className:"flex flex-col gap-y-8 py-4",children:[(0,g.jsx)(Es,{}),(0,g.jsx)(Ss,{}),(0,g.jsx)(Is,{}),(0,g.jsx)(zs,{})]})}function Ms(e){let{children:t,...s}=e;return(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)(he,{...s,className:"absolute top-[-8px] right-[-8px]"}),t]})}function Os(e){let{workspace_id:t,onSubmit:s,onCreated:l}=e;const{values:n,touched:i,errors:a,isSubmitting:r,getFieldProps:o,handleSubmit:d}=(0,W.Wx)({initialValues:{title:""},validationSchema:Z.Ik().shape({title:Z.Yj().required("Title is required")}),onSubmit:async(e,n)=>{n.setSubmitting(!0);try{const i=await h.A.post("/rooms",{workspace_id:t,title:e.title});K.oR.success("Room has been created in your workspace."),l&&l(i.data.data),n.setSubmitting(!1),s&&s()}catch(i){n.setSubmitting(!1)}}});return(0,g.jsxs)("form",{onSubmit:d,className:"flex flex-col gap-y-6",children:[(0,g.jsx)(Y.A,{...o("title"),placeholder:"Enter the room title",label:"Room title",hasError:!!i.title&&!!a.title,helperText:!!i.title&&!!a.title&&a.title}),(0,g.jsx)(L.A,{type:"submit",disabled:!n.title,loading:r,children:"Create"})]})}function Vs(e){let{workspace_id:t,onAdd:s}=e;return(0,g.jsx)(q,{trigger:e=>(0,g.jsx)(L.A,{className:"text-gray-600",variant:"ghost",startIcon:(0,g.jsx)(X.A,{size:16}),onClick:e,children:"Add Room"}),children:(e,l)=>(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(J,{children:"Adding room to workspace"}),(0,g.jsx)(G,{children:"You are going to create room in your workspace"}),(0,g.jsx)(Os,{workspace_id:t,onSubmit:l,onCreated:s})]})})}var Us=s(9839);function Fs(e){let{trigger:t,children:s,onClose:l,dialogContentCss:n,...a}=e;const[r,o]=(0,i.useState)(!1);return(0,g.jsxs)(I,{open:r,onOpenChange:o,modal:!0,children:[(0,g.jsx)($,{asChild:!0,children:t((()=>o(!0)))}),(0,g.jsx)(U,{className:n,children:s((()=>{o(!1),l&&l()}))})]})}function Hs(e){let{title:t,description:s,onClose:l,loading:n=!1,onSubmit:i,submitText:a="Submit",afterDesc:r,hasNotAction:o=!1}=e;return(0,g.jsxs)("div",{className:"flex flex-col gap-y-8",children:[(0,g.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,g.jsx)("strong",{className:"text-xl",children:t}),!!s&&(0,g.jsx)("p",{className:"text-base text-black/60",children:s}),!!r&&r]}),!1===o&&(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-2",children:[(0,g.jsx)(L.A,{onClick:l,className:"!px-6",variant:"outline",children:"Close"}),(0,g.jsx)(L.A,{loading:n,onClick:i,className:"!px-6",children:a})]})]})}function Js(e){let{room:t,onDelete:s}=e;const{startLoading:l,stopLoading:n,isLoading:i}=a(),{workspace_id:r}=b(),o=()=>{l(),h.A.delete(`workspaces/${r}/rooms/${t.id}`).then((e=>{n(),s&&s()})).catch((e=>{n()}))};return(0,g.jsx)(Fs,{trigger:e=>(0,g.jsx)(ee.A,{onClick:e,disabled:i,children:(0,g.jsx)(dt.A,{size:16,className:"text-red-600"})}),children:e=>(0,g.jsx)(Hs,{title:"Delete room",submitText:"Delete",description:"Are you sure to delete this room?!",onSubmit:o,onClose:e})})}function Gs(e){let{workspace_id:t,room:s,selected_room_id:l,participants:n}=e;const{sounds:i}=c(),r=(0,p.Zp)(),o=(0,v.FO)(),{startLoading:d,stopLoading:u,isLoading:x}=a(),j=!!l&&(null===s||void 0===s?void 0:s.id)===l;let b="!justify-start !text-left flex-1";return j&&(b+=" !bg-black/10 !text-black"),(0,g.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,g.jsxs)("div",{className:"flex flex-row items-center justify-between gap-x-2",children:[(0,g.jsx)(L.A,{onClick:async()=>{o&&l!==s.id&&(d(),o.emit("joinedRoom",s.id,(()=>{h.A.get(`/rooms/${s.id}/join`).then((e=>{const l=e.data.data.token;u(),i.userJoinLeft&&m("joined"),l&&r((0,f.sB)(`/workspaces/${t}/rooms/${s.id}`,{token:l,isSwitching:!0}))})).catch((e=>{u()}))})))},className:b,variant:j?"default":"ghost",startIcon:(0,g.jsx)(Us.A,{className:"mr-2",size:16}),disabled:x,loading:x,children:s.title}),(0,g.jsx)(Js,{room:s,onDelete:()=>{}})]}),(0,g.jsx)(Cs,{roomId:s.id,participants:(0,f.ar)(n)})]})}function qs(e){let{workspace_id:t,rooms:s,selected_room_id:l}=e;const{workpaceUsers:n}=b();return 0===s.length?null:(0,g.jsx)(vt,{title:"Rooms",children:s.map((e=>(0,g.jsx)(Gs,{selected_room_id:l,workspace_id:t,room:e,participants:n.filter((t=>t.room_id===e.id&&"online"===t.status))},e.id)))})}function Bs(e){let{workspace_id:t}=e;const{room_id:s}=(0,p.g)(),[l,a]=(0,i.useState)([]),{data:r,isLoading:o,mutate:d}=(0,n.g)(`/workspaces/${t}/rooms`),c=r?null===r||void 0===r?void 0:r.data:[];(0,i.useEffect)((()=>{c.length>0&&a(c)}),[c]),(0,v.FO)("workspaceRoomUpdated",(e=>{const t=e;a((e=>e.map((e=>e.id===t.id?t:e))))}));let u=(0,g.jsxs)("div",{className:"flex flex-col",children:[(0,g.jsx)(qs,{workspace_id:+t,rooms:l,selected_room_id:s?+s:void 0}),(0,g.jsx)(Vs,{workspace_id:t,onAdd:e=>d()})]});return o&&(u=(0,g.jsx)(Te.A,{})),u}function Ys(){const{workspace_id:e}=(0,p.g)();return(0,g.jsx)("div",{className:"flex flex-col gap-y-4 bg-white h-screen overflow-y-auto p-4",children:(0,g.jsx)(Bs,{workspace_id:e})})}function Ws(){var e;const t=(0,d.GV)((e=>e.room)),s=null!==(e=null===t||void 0===t?void 0:t.messages_count)&&void 0!==e?e:{room:[],objects:{}},l=s.room,n=null===Object||void 0===Object?void 0:Object.values(s.directs).flatMap((e=>e)),a=l.length+n.length,[r,o]=(0,i.useState)("rooms");let c="";if("chat"===r)c=(0,g.jsx)(T,{});return(0,g.jsx)("div",{className:"p-6 flex flex-col gap-y-4",children:(0,g.jsx)(_,{title:(0,g.jsx)("div",{children:c}),defaultValue:r,onChangeTab:o,className:"[&_.tab-content>*]:px-0",items:[{icon:(0,g.jsx)(R.A,{}),content:(0,g.jsx)(Ys,{}),value:"rooms"},{icon:(0,g.jsx)(Ms,{count:a,children:(0,g.jsx)(E.A,{})}),content:(0,g.jsx)(ys,{}),value:"chat"},{icon:(0,g.jsx)(z.A,{}),content:(0,g.jsx)($s,{}),value:"users"}]})})}var Xs=s(637);const Ks=[0,0],Zs=()=>{var e;const t=(0,Xs.K)(),{room:s}=b(),l=null!==(e=null===s||void 0===s?void 0:s.participants)&&void 0!==e?e:[],n=(e,t)=>{var s,l,n,i;const a=null===(s=null!==e&&void 0!==e&&e.coordinates?null===e||void 0===e||null===(l=e.coordinates)||void 0===l?void 0:l.split(","):Ks)||void 0===s?void 0:s.map((e=>+e)),r=null===(n=null!==t&&void 0!==t&&t.coordinates?null===t||void 0===t||null===(i=t.coordinates)||void 0===i?void 0:i.split(","):Ks)||void 0===n?void 0:n.map((e=>+e));return Math.sqrt(Math.pow(a[0]-r[0],2)+Math.pow(a[1]-r[1],2))<100},i=e=>{var t,s;const l=null===(t=null!==e&&void 0!==e&&e.coordinates?null===e||void 0===e||null===(s=e.coordinates)||void 0===s?void 0:s.split(","):Ks)||void 0===t?void 0:t.map((e=>+e)),n=Math.sqrt(Math.pow(l[0]-500,2)+Math.pow(l[1]-500,2))/50;return Math.min(Math.max(n,0),1)},a=(e,l)=>{if(s){const s=t.find((t=>t.identity===e));void 0!==s&&(s.audioLevel=100)}};return(0,v.FO)("updateCoordinates",(e=>{(()=>{for(let e=0;e<l.length;e++)for(let t=e+1;t<l.length;t++)if(n(l[e],l[t])){const s=i(l[e]),n=i(l[t]);a(""+l[e].username,s),a(""+l[t].username,n)}else a(""+l[e].username,0),a(""+l[t].username,0)})()})),null};var Qs=s(3192);function el(){const{mediaPermissions:e}=Ha(),{localParticipant:t}=(0,Xs.C)(),s=t.getTrackPublication(Qs.CC.Source.Camera),l=null===s||void 0===s?void 0:s.track;return(0,i.useEffect)((()=>{l&&(!0===(null===e||void 0===e?void 0:e.video)?l.unmute():(l.mute(),l.stop()))}),[null===e||void 0===e?void 0:e.video,l]),null}function tl(){const{mediaPermissions:e}=Ha(),{localParticipant:t}=(0,Xs.C)(),s=t.getTrackPublication(Qs.CC.Source.Microphone),l=null===s||void 0===s?void 0:s.track;return(0,i.useEffect)((()=>{l&&(!0===(null===e||void 0===e?void 0:e.audio)?l.unmute():l.mute())}),[null===e||void 0===e?void 0:e.audio,l]),null}function sl(){return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(el,{}),(0,g.jsx)(tl,{})]})}var ll=s(2733),nl=s(7892);const il=i.forwardRef((function(e,t){let{trackRef:s,onSubscriptionStatusChanged:l,volume:n,muted:a,...r}=e;const o=(0,nl.i)(s),d=i.useRef(null);i.useImperativeHandle(t,(()=>d.current));const{elementProps:c,isSubscribed:u,track:x,publication:m}=function(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[l,n]=i.useState((0,ll.yE)(e)),[a,r]=i.useState(null===l||void 0===l?void 0:l.isMuted),[o,d]=i.useState(null===l||void 0===l?void 0:l.isSubscribed),[c,u]=i.useState(null===l||void 0===l?void 0:l.track),[x,m]=i.useState("landscape"),v=i.useRef(),{className:h,trackObserver:p}=i.useMemo((()=>(0,ll.Lh)(e)),[null!==(t=e.participant.sid)&&void 0!==t?t:e.participant.identity,e.source,(0,ll.zF)(e)&&e.publication.trackSid]);return i.useEffect((()=>{const e=p.subscribe((e=>{ll.Rm.debug("update track",e),n(e),r(null===e||void 0===e?void 0:e.isMuted),d(null===e||void 0===e?void 0:e.isSubscribed),u(null===e||void 0===e?void 0:e.track)}));return()=>null===e||void 0===e?void 0:e.unsubscribe()}),[p]),i.useEffect((()=>{var t,l;return c&&(v.current&&c.detach(v.current),null===(l=s.element)||void 0===l||!l.current||(0,ll.IX)(e.participant)&&"audio"===(null===c||void 0===c?void 0:c.kind)||c.attach(s.element.current)),v.current=null===(t=s.element)||void 0===t?void 0:t.current,()=>{v.current&&(null===c||void 0===c||c.detach(v.current))}}),[c,s.element]),i.useEffect((()=>{var e,t;if("number"===typeof(null===l||void 0===l||null===(e=l.dimensions)||void 0===e?void 0:e.width)&&"number"===typeof(null===l||void 0===l||null===(t=l.dimensions)||void 0===t?void 0:t.height)){const e=l.dimensions.width>l.dimensions.height?"landscape":"portrait";m(e)}}),[l]),{publication:l,isMuted:a,isSubscribed:o,track:c,elementProps:(0,f.v6)(s.props,{className:h,"data-lk-local-participant":e.participant.isLocal,"data-lk-source":null===l||void 0===l?void 0:l.source,..."video"===(null===l||void 0===l?void 0:l.kind)&&{"data-lk-orientation":x}})}}(o,{element:d,props:r});return i.useEffect((()=>{null===l||void 0===l||l(!!u)}),[u,l]),i.useEffect((()=>{void 0!==x&&void 0!==n&&(x instanceof Qs.EQ?x.setVolume(n):ll.Rm.warn("Volume can only be set on remote audio tracks."))}),[n,x]),i.useEffect((()=>{void 0!==m&&void 0!==a&&(m instanceof Qs.u6?m.setEnabled(!a):ll.Rm.warn("Can only call setEnabled on remote track publications."))}),[a,m,x]),(0,g.jsx)("audio",{ref:d,...c})}));function al(){var e;const{user:t}=(0,ce.A)(),{room:s}=b(),l=null!==(e=null===s||void 0===s?void 0:s.participants)&&void 0!==e?e:[],n=null===l||void 0===l?void 0:l.find((e=>(null===e||void 0===e?void 0:e.username)===(null===t||void 0===t?void 0:t.username))),i=(0,Xs.t)([Qs.CC.Source.Microphone,Qs.CC.Source.ScreenShareAudio,Qs.CC.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!0}).filter((e=>!(0,ll.IX)(e.participant)&&e.publication.kind===Qs.CC.Kind.Audio));return(0,g.jsx)("div",{style:{display:"none"},children:i.map((e=>{const t=null===l||void 0===l?void 0:l.find((t=>{var s;return t.username===(null===e||void 0===e||null===(s=e.participant)||void 0===s?void 0:s.identity)})),{meet:s,volumePercentage:i}=dl(n,t);let a=!s;return(0,g.jsx)(il,{trackRef:e,volume:1,muted:a},(0,ll.kW)(e))}))})}const rl=0,ol=0;function dl(e,t){var s,l,n,i,a,r;if(!t||!e)return{distance:void 0,meet:!1,volumePercentage:0};const o=Ut.c.voiceAreaRadius-50,d=null!==(s=null===(l=e.coordinates)||void 0===l||null===(n=l.split(","))||void 0===n?void 0:n.map((e=>+e)))&&void 0!==s?s:[rl,ol],c=d[0],u=d[1],x=null!==(i=null===(a=t.coordinates)||void 0===a||null===(r=a.split(","))||void 0===r?void 0:r.map((e=>+e)))&&void 0!==i?i:[rl,ol],m=x[0],f=x[1],v=Math.sqrt(Math.pow(c-m,2)+Math.pow(u-f,2)),h=v<=92+o;return{meet:h,distance:v,volumePercentage:h?100-Math.min(v/o*100,100):0}}function cl(e){let{children:t}=e;return(0,g.jsxs)(g.Fragment,{children:[t,(0,g.jsx)(al,{})]})}function ul(e){let{children:t}=e;return(0,g.jsx)("div",{className:"absolute bottom-0 right-0 z-[2]",children:t})}var xl=s(5381);function ml(e){let{trackRef:t}=e;const{isMuted:s}=(0,Xs.k)(t);return(0,g.jsx)(ee.A,{className:"w-8 h-8 text-black/60",children:s?(0,g.jsx)(xl.A,{size:22}):(0,g.jsx)(Oe.A,{size:22})})}var fl=s(3949);const vl=()=>null;function hl(e){let{children:t}=e;return(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)(vl,{}),t]})}function pl(e){let{isDragging:t}=e;const s=2*Ut.c.voiceAreaRadius;let l={};return t&&(l={width:s,height:s}),(0,g.jsx)("div",{className:"w-[0px] h-[0px] transition-all absolute top-[50%] left-[50%] translate-x-[-50%] translate-y-[-50%] bg-green-500/20 rounded-full",style:l})}function gl(e){const t=!!(0,nl.B)();return e.participant&&!t?(0,g.jsx)(nl.af.Provider,{value:e.participant,children:e.children}):(0,g.jsx)(g.Fragment,{children:e.children})}function jl(e){const t=!!(0,nl.a9)();return e.trackRef&&!t?(0,g.jsx)(nl.ag.Provider,{value:e.trackRef,children:e.children}):(0,g.jsx)(g.Fragment,{children:e.children})}const bl=i.forwardRef((function(e,t){var s,l,n,a,r,o,d;let{trackRef:c,children:u,onParticipantClick:x,disableSpeakingIndicator:m,isDragging:v,username:h,...p}=e;const j=(0,nl.i)(c),{elementProps:w}=(0,Xs.l)({htmlProps:p,disableSpeakingIndicator:m,onParticipantClick:x,trackRef:j}),y=(0,nl.j)(),N=null===(s=(0,nl.ah)())||void 0===s?void 0:s.autoSubscription,k=i.useCallback((e=>{j.source&&!e&&y&&y.pin.dispatch&&function(e,t){return"undefined"!==typeof t&&((0,nl.a1)(e)?t.some((t=>t.participant.identity===e.participant.identity&&(0,nl.a1)(t)&&t.publication.trackSid===e.publication.trackSid)):!!(0,ll.Uc)(e)&&t.some((t=>t.participant.identity===e.participant.identity&&(0,ll.Uc)(t)&&t.source===e.source)))}(j,y.pin.state)&&y.pin.dispatch({msg:"clear_pin"})}),[j,y]),A=null===(l=j.participant)||void 0===l?void 0:l.identity,{isMuted:C}=(0,Xs.k)(c),S=null===j||void 0===j||null===(n=j.participant)||void 0===n?void 0:n.isSpeaking;let _="relative z-[10] user-circle transition-all w-full h-full [&_.lk-participant-tile]:!absolute [&_.lk-participant-tile]:w-full [&_.lk-participant-tile]:h-full [&_.lk-participant-tile]:top-0 [&_.lk-participant-tile]:left-0 rounded-full p-1 [&_video]:h-full [&_video]:object-cover [&_video]:rounded-full [&_video]:h-full [&_video]:w-full w-[96px] h-[96px] flex flex-col items-center justify-center";const{user:R}=(0,ce.A)(),{room:E}=b(),z=null!==(a=null===E||void 0===E?void 0:E.participants)&&void 0!==a?a:[],L=null===z||void 0===z?void 0:z.find((e=>(null===e||void 0===e?void 0:e.username)===(null===R||void 0===R?void 0:R.username))),T=null===z||void 0===z?void 0:z.find((e=>(null===e||void 0===e?void 0:e.username)===h)),P=(0,f.O1)(T);let D=null;var I;(0,nl.a1)(j)&&(D=(0,g.jsx)(fl.u,{trackRef:j,onSubscriptionStatusChanged:k}),"video"===(null===(I=j.publication)||void 0===I?void 0:I.kind)&&j.source===Qs.CC.Source.Camera&&(D=(0,g.jsx)(fl.V,{trackRef:j,onSubscriptionStatusChanged:k,manageSubscription:N})));let $=!0;const{meet:M}=dl(L,T);!C&&(null===c||void 0===c?void 0:c.source)===Qs.CC.Source.Camera&&M&&($=!1),M||(_+=" scale-[0.6]"),S&&M&&(_+=" bg-green-700"),S||(_+=" bg-black/10"),M||(_+=" bg-gray-600");const{quality:O}=(0,Xs.i)({participant:j.participant});let V=P;return O!==Qs._N.Lost&&O!==Qs._N.Poor||(V="Poor connection!"),(0,g.jsx)(ze,{title:V,children:(0,g.jsx)(Yt,{roomId:null===E||void 0===E?void 0:E.id,user:T,children:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(pl,{isDragging:v}),(0,g.jsxs)("div",{className:_,children:[(0,g.jsxs)("div",{className:"relative w-[86px] h-[86px] rounded-full flex flex-col items-center justify-center",children:[$&&(0,g.jsx)(me.A,{className:"absolute top-0 left-0 w-full h-full z-[1]",src:null!==(r=null===T||void 0===T||null===(o=T.avatar)||void 0===o?void 0:o.url)&&void 0!==r?r:"",title:null!==(d=null===P||void 0===P?void 0:P[0])&&void 0!==d?d:null===A||void 0===A?void 0:A[0]}),(0,g.jsx)("div",{className:"",children:(0,g.jsx)("div",{ref:t,style:{position:"relative"},...w,children:(0,g.jsx)(jl,{trackRef:j,children:(0,g.jsx)(gl,{participant:j.participant,children:null!==u&&void 0!==u?u:(0,g.jsx)(g.Fragment,{children:D})})})})})]}),(0,g.jsx)(ul,{children:(0,g.jsx)(ml,{trackRef:{participant:j.participant,source:Qs.CC.Source.Microphone}})})]})]})})})}));function wl(e){let{defaultIsDragging:t,username:s}=e;const{track:l}=Sl();return(0,g.jsx)(hl,{children:(0,g.jsx)(bl,{trackRef:l,username:s,isDragging:t})})}var yl=s(7719);function Nl(e){let{quality:t}=e;if(t===Qs._N.Unknown)return null;if(t===Qs._N.Excellent)return null;if(t===Qs._N.Good)return null;let s=(0,g.jsx)(yl.A,{size:32});return(0,g.jsx)("div",{className:(0,f.cn)("absolute top-0 left-0 w-full h-full rounded-full bg-yellow-500/40 text-yellow-700 z-[1000] flex items-center justify-center"),children:s})}function kl(e){let{children:t,quality:s}=e;return(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)(Nl,{quality:s}),t]})}function Al(e){const t=!!(0,nl.B)();return e.participant&&!t?(0,g.jsx)(nl.af.Provider,{value:e.participant,children:e.children}):(0,g.jsx)(g.Fragment,{children:e.children})}const Cl=(0,i.createContext)({track:void 0,draggable:!1}),Sl=()=>(0,i.useContext)(Cl);function _l(e){const t=!!(0,nl.a9)();return e.trackRef&&!t?(0,g.jsx)(nl.ag.Provider,{value:e.trackRef,children:e.children}):(0,g.jsx)(g.Fragment,{children:e.children})}function Rl(e){let{participant:t,track:s,draggable:l=!1,isDragging:n=!1,username:a}=e;const r=s,o=(0,nl.a9)(),d=(0,i.useMemo)((()=>{var e,t,s;return{participant:null!==(e=null===r||void 0===r?void 0:r.participant)&&void 0!==e?e:null===o||void 0===o?void 0:o.participant,source:null!==(t=null===r||void 0===r?void 0:r.source)&&void 0!==t?t:null===o||void 0===o?void 0:o.source,publication:null!==(s=null===r||void 0===r?void 0:r.publication)&&void 0!==s?s:null===o||void 0===o?void 0:o.publication}}),[o,r]),{quality:c}=(0,Xs.i)({participant:t});return(0,g.jsx)(_l,{trackRef:d,children:(0,g.jsx)(Al,{participant:null!==t&&void 0!==t?t:null===d||void 0===d?void 0:d.participant,children:(0,g.jsx)(Cl.Provider,{value:{track:d,draggable:l},children:(0,g.jsx)(kl,{quality:c,children:(0,g.jsx)(wl,{defaultIsDragging:n,username:a})})})})})}const El=e=>{var t,s;const{data:l,dragging:n}=e,a=(0,Xs.t)([{source:Qs.CC.Source.Camera,withPlaceholder:!0},{source:Qs.CC.Source.ScreenShare,withPlaceholder:!1}],{updateOnlyOn:[Qs.u9.ActiveSpeakersChanged,Qs.u9.Reconnected,Qs.u9.Reconnecting,Qs.u9.MediaDevicesChanged,Qs.u9.LocalTrackPublished,Qs.u9.TrackUnsubscribed],onlySubscribed:!0}),r=(0,Xs.K)(),o=(0,i.useMemo)((()=>r.find((e=>e.identity===l.username))),[r]),d=(0,i.useMemo)((()=>{if(null!==l&&void 0!==l&&l.username&&0!==a.length)return a.find((e=>e.participant.identity===l.username))}),[a,l.username]);return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(Rl,{participant:o,track:d,draggable:null!==(t=null===l||void 0===l?void 0:l.draggable)&&void 0!==t&&t,isDragging:n,username:null!==(s=null===l||void 0===l?void 0:l.username)&&void 0!==s?s:""})})};var zl=s(1523),Ll=s(8969),Tl=s(292),Pl=s(2668);const Dl=function(e,t){(0,i.useEffect)((()=>{const s=s=>{s.key===e&&t()};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}}),[e,t])};var Il=s(7950),$l=s(7044);const Ml=e=>{let{children:t}=e,s=(0,g.jsx)("div",{className:"resizer m-1 z-[2] flex items-center justify-center cursor-nwse-resize right-[-10px] bottom-[-10px]  w-[48px] h-[48px] bg-white shadow-lg rounded-full absolute",children:(0,g.jsx)($l.A,{size:26})});return(0,i.useEffect)((()=>{(e=>{const t=document.querySelector(e),s=document.querySelector(e+" .resizer");if(null===t||null===s)return;let l=0,n=0,i=0,a=0,r=1;function o(e){if(e.preventDefault(),e.stopPropagation(),s&&t){const s=e.clientX-i,n=e.clientY-a,o=Math.abs(s)>Math.abs(n)?s:n;let d=l+o,c=d/r;d>20&&c>20&&(t.style.width=d+"px",t.style.height=c+"px")}}function d(){window.removeEventListener("mousemove",o)}s.addEventListener("mousedown",(function(e){e.preventDefault(),e.stopPropagation(),l=parseFloat(getComputedStyle(t,null).getPropertyValue("width").replace("px","")),n=parseFloat(getComputedStyle(t,null).getPropertyValue("height").replace("px","")),r=l/n,i=e.clientX,a=e.clientY,window.addEventListener("mousemove",o),window.addEventListener("mouseup",d)}))})(".resizable")}),[]),(0,g.jsxs)("div",{className:"resizable relative [&_.resizer]:opacity-0 [&_.resizer]:hover:opacity-100",children:[s,t]})};function Ol(e){var t,s,l;let{track:n}=e;const{room:a}=b(),{user:r}=(0,ce.A)(),[o,d]=(0,i.useState)(!1),[c,u]=(0,i.useState)(!1);let x="w-[400px] h-[160px] relative transition-all [&_.actions]:hover:opacity-100 [&_.actions]:hover:visible";o?x+=" !fixed bg-black !w-screen !h-screen top-0 left-0 bottom-0 right-0 z-[1000] [&_video]:w-full [&_video]:h-full":c&&(x+=" fixed !w-[1200px] !h-[480px]");const m=null===n||void 0===n||null===(t=n.participant)||void 0===t?void 0:t.identity,f=null===a||void 0===a||null===(s=a.participants)||void 0===s?void 0:s.find((e=>e.username===m)),v=null===a||void 0===a||null===(l=a.participants)||void 0===l?void 0:l.find((e=>e.username===(null===r||void 0===r?void 0:r.username))),h=m===(null===r||void 0===r?void 0:r.username),{meet:p}=dl(v,f);if(Dl("Escape",(()=>d(!1))),!p)return null;const j=(0,g.jsx)(fl.V,{trackRef:n});let w=(0,g.jsxs)("div",{className:x,children:[(0,g.jsxs)("div",{className:"actions absolute top-4 left-4 flex flex-row items-center gap-x-2 opacity-0 invisible transition-all",children:[(0,g.jsx)(ee.A,{className:"text-black/60 z-10",onClick:()=>d((e=>!e)),children:o?(0,g.jsx)(zl.A,{}):(0,g.jsx)(Ll.A,{})}),(0,g.jsx)(ee.A,{className:"text-black/60 z-10",onClick:()=>u((e=>!e)),children:c?(0,g.jsx)(Tl.A,{}):(0,g.jsx)(Pl.A,{})}),!!h&&(0,g.jsx)(ee.A,{className:"text-black/60 z-10",onClick:()=>(0,de.J)(ue.X.stopMyScreenSharing),children:(0,g.jsx)(D.A,{})})]}),o||c?j:(0,g.jsx)(Ml,{children:(0,g.jsx)("div",{className:" rounded-lg overflow-hidden",children:j})})]});return o?(0,Il.createPortal)(w,document.getElementById("portal")):w}function Vl(e){let{children:t}=e;return(0,g.jsx)("div",{className:"absolute top-4 left-4 z-10",children:t})}function Ul(e){let{children:t}=e;return(0,g.jsx)("div",{className:"absolute top-4 right-4 z-10",children:t})}function Fl(e){let{children:t}=e;return(0,g.jsx)("div",{className:"absolute bottom-4 left-4 z-10",children:t})}function Hl(e){let{children:t}=e;return(0,g.jsx)("div",{className:"absolute bottom-4 right-4 z-10",children:t})}function Jl(e){let{children:t}=e;return(0,g.jsx)("div",{className:"absolute bottom-4 left-[50%] translate-x-[-50%] z-10",children:t})}function Gl(e){let{topLeft:t,topRight:s,bottomLeft:l,bottomRight:n,bottomMiddle:i}=e;const{sidebar:a}=b();return(0,g.jsxs)("div",{className:"relative h-screen w-full",children:[(0,g.jsx)(Vl,{children:t}),(0,g.jsx)(Ul,{children:s}),(0,g.jsx)(Fl,{children:l}),(0,g.jsx)(Jl,{children:i}),(0,g.jsx)(Hl,{children:n})]})}var ql=s(1073),Bl=s(74),Yl=s(567);function Wl(e){let{className:t}=e;const{data:s,isLoading:l}=(0,n.g)("/workspaces"),i=s?null===s||void 0===s?void 0:s.data:[];let a=(0,g.jsx)(Yl.A,{items:i});return l&&(a=(0,g.jsx)(Te.A,{})),(0,g.jsx)("div",{className:"flex flex-col gap-y-4",children:(0,g.jsx)("div",{className:`flex flex-col gap-y-4 p-6 ${null!==t&&void 0!==t?t:""}`,children:(0,g.jsx)(Bl.A,{title:"Workspaces",children:a})})})}function Xl(){return(0,g.jsx)(B,{trigger:e=>(0,g.jsx)(L.A,{onClick:e,startIcon:(0,g.jsx)(ql.A,{}),className:"bg-white hover:bg-white text-black rounded-xl",children:"Workspaces"}),className:"w-[640px]",children:(e,t)=>(0,g.jsx)(Wl,{})})}function Kl(e){var t,s;let{trigger:l,children:n,className:a}=e;const r=(0,i.useRef)(null),[o,d]=(0,i.useState)(!1),c=()=>{d(!1),x(void 0)};Dl("Escape",c);const[u,x]=(0,i.useState)(),m=()=>{var e,t,s,l,n;if(o)return;const i=null===(e=r.current)||void 0===e?void 0:e.getBoundingClientRect(),a=null!==(t=null===i||void 0===i?void 0:i.top)&&void 0!==t?t:0,c=null!==(s=null===i||void 0===i?void 0:i.left)&&void 0!==s?s:0,u=null!==(l=null===i||void 0===i?void 0:i.height)&&void 0!==l?l:0,m=null!==(n=null===i||void 0===i?void 0:i.width)&&void 0!==n?n:0;void 0!==a&&void 0!==c&&(d(!0),x({top:a,left:c,height:u,width:m}))};let f="trigger transition-all",v="modaloverlay transition-all";return o&&(f+=" fixed z-20 scale-[1.05]"),o&&(v+=" fixed z-10 top-0 left-0 w-screen h-screen bg-black/50 backdrop-blur-sm"),(0,g.jsxs)(g.Fragment,{children:[!!o&&(0,g.jsx)("div",{className:"placeholder-trigger",style:{...u}}),(0,g.jsx)("div",{className:f,style:u||{},ref:r,children:l(m)}),o&&(0,g.jsx)("div",{className:v,onClick:c}),!!n&&o&&n({top:(null!==(t=null===u||void 0===u?void 0:u.top)&&void 0!==t?t:0)+(null!==(s=null===u||void 0===u?void 0:u.height)&&void 0!==s?s:0),left:null===u||void 0===u?void 0:u.left,zIndex:21},m,c)]})}function Zl(e){let{children:t,onClose:s,top:l,left:n,zIndex:i,width:a=300,title:r}=e;return(0,g.jsx)("div",{className:"bg-background rounded-lg p-4 fixed mt-4",style:{width:a,top:l,left:n,zIndex:null!==i&&void 0!==i?i:100},children:(0,g.jsx)(Pt,{title:r,onClose:s,children:t})})}var Ql=s(8800);function en(e){let{onDelete:t,onCreated:s}=e;return(0,g.jsx)(B,{trigger:e=>(0,g.jsx)(L.A,{startIcon:(0,g.jsx)(X.A,{}),onClick:e,children:"Add Schedule"}),className:"w-[640px]",children:(e,t)=>(0,g.jsx)(Ct,{onClose:t,onCreated:()=>{s&&s(),t()}})})}function tn(e){let{onGetMySchedules:t}=e;const{data:s,isLoading:l,mutate:a}=(0,n.g)("/users/me/schedules"),r=void 0!==s?null===s||void 0===s?void 0:s.data:[];(0,i.useEffect)((()=>{t&&t(r)}),[t,r]);let o=null;return r.length>0&&(o=(0,g.jsx)(Lt,{justView:!1,items:r,onDelete:a})),l||void 0===s?(0,g.jsx)(Te.A,{}):(0,g.jsxs)("div",{className:"flex flex-col gap-y-2 items-end",children:[o,(0,g.jsx)(en,{onDelete:a,onCreated:a})]})}function sn(){const[e,t]=(0,i.useState)([]),s=(0,i.useCallback)((e=>{t(e)}),[]),l=(0,i.useMemo)((()=>(0,f.bQ)(e)),[e]);return(0,g.jsx)(Kl,{trigger:e=>(0,g.jsx)(L.A,{onClick:e,startIcon:(0,g.jsx)(Ql.A,{}),className:"bg-white hover:bg-white text-black rounded-xl",children:"Schedule"}),className:"w-[551px]",children:(e,t,n)=>(0,g.jsx)(Zl,{top:e.top,left:e.left,zIndex:e.zIndex,onClose:n,title:`Schedule (${null!==l&&void 0!==l?l:0}h) per week`,width:400,children:(0,g.jsx)(tn,{onGetMySchedules:s})})})}var ln=s(3190),nn=s(4380),an=s(9868);const rn=nn.bL,on=nn.l9;nn.YJ,nn.ZL,nn.Pb,nn.z6;i.forwardRef(((e,t)=>{let{className:s,inset:l,children:n,...i}=e;return(0,g.jsxs)(nn.ZP,{ref:t,className:(0,f.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",l&&"pl-8",s),...i,children:[n,(0,g.jsx)(wt.A,{className:"ml-auto h-4 w-4"})]})})).displayName=nn.ZP.displayName;i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(nn.G5,{ref:t,className:(0,f.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})})).displayName=nn.G5.displayName;const dn=i.forwardRef(((e,t)=>{let{className:s,sideOffset:l=4,...n}=e;return(0,g.jsx)(nn.ZL,{children:(0,g.jsx)(nn.UC,{ref:t,sideOffset:l,className:(0,f.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})})}));dn.displayName=nn.UC.displayName;const cn=i.forwardRef(((e,t)=>{let{className:s,inset:l,...n}=e;return(0,g.jsx)(nn.q7,{ref:t,className:(0,f.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l&&"pl-8",s),...n})}));cn.displayName=nn.q7.displayName;i.forwardRef(((e,t)=>{let{className:s,children:l,checked:n,...i}=e;return(0,g.jsxs)(nn.H_,{ref:t,className:(0,f.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:n,...i,children:[(0,g.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,g.jsx)(nn.VF,{children:(0,g.jsx)(Ge.A,{className:"h-4 w-4"})})}),l]})})).displayName=nn.H_.displayName;i.forwardRef(((e,t)=>{let{className:s,children:l,...n}=e;return(0,g.jsxs)(nn.hN,{ref:t,className:(0,f.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,g.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,g.jsx)(nn.VF,{children:(0,g.jsx)(an.A,{className:"h-2 w-2 fill-current"})})}),l]})})).displayName=nn.hN.displayName;i.forwardRef(((e,t)=>{let{className:s,inset:l,...n}=e;return(0,g.jsx)(nn.JU,{ref:t,className:(0,f.cn)("px-2 py-1.5 text-sm font-semibold",l&&"pl-8",s),...n})})).displayName=nn.JU.displayName;i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)(nn.wv,{ref:t,className:(0,f.cn)("-mx-1 my-1 h-px bg-muted",s),...l})})).displayName=nn.wv.displayName;const un=e=>{var t;let{items:s,onSelect:l,defaultValue:n,className:a=" "}=e;const[r,o]=(0,i.useState)("Choose"),d=(0,i.useRef)(null);(0,i.useEffect)((()=>{void 0!==n&&o(n)}),[n]);const c=(0,i.useCallback)((e=>{o(e.title),l&&l(e)}),[l]);return(0,g.jsxs)(rn,{children:[(0,g.jsx)(on,{className:"border rounded-md  w-full",children:(0,g.jsxs)("div",{ref:d,className:"flex w-full p-2 px-4 items-center justify-between",children:[(0,g.jsx)("span",{children:r}),(0,g.jsx)(He.A,{size:16})]})}),(0,g.jsx)(dn,{style:{width:null!==d&&void 0!==d&&d.current?null===(t=d.current)||void 0===t?void 0:t.clientWidth:"100%"},className:`z-[10000] ${a}`,children:(0,g.jsx)("div",{className:"flex flex-col gap-y-2",children:s.map(((e,t)=>(0,g.jsx)(cn,{className:"cursor-pointer",onSelect:()=>c(e),children:e.title},t+1)))})})]})},xn=i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)("textarea",{className:(0,f.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...l})}));function mn(e){var t;let{label:s,helperText:l,hasError:n,required:i=!1,...a}=e,r=null!==(t=null===a||void 0===a?void 0:a.className)&&void 0!==t?t:"",o="text-sm font-normal text-black/60";return n&&(r+=" border !ring-red-600 border-red-600",o+=" text-red-600"),(0,g.jsxs)("div",{className:"flex flex-col gap-y-2 w-full",children:[s&&(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-1",children:[(0,g.jsx)("strong",{className:"font-semibold text-black/[.87] text-base",children:s}),!!i&&(0,g.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,g.jsx)(xn,{...a,className:r}),l&&(0,g.jsx)("span",{"data-testid":"hint-text",className:o,children:l})]})}xn.displayName="Textarea";const fn=e=>{let{jobId:t,onDelete:s}=e;const{startLoading:l,stopLoading:n,isLoading:i}=a();return(0,g.jsx)(L.A,{onClick:()=>{l(),h.A.delete(`/jobs/${t}`).then((e=>{K.oR.success("Job has been deleted"),s&&s(),n()})).catch((()=>{n()}))},startIcon:(0,g.jsx)(dt.A,{size:16}),className:"w-full !border-red-500 !text-red-500",variant:"outline",loading:i,children:"Delete job"})},vn=[{title:"In Progress",value:"in_progress"},{title:"Completed",value:"completed"},{title:"Paused",value:"paused"},{title:"Started",value:"started"}],hn=e=>{var t;let{defaultValue:s,workspaceId:l,onCreated:n,onDelete:i,onClose:r}=e;const o=void 0!==s,{isLoading:d,stopLoading:c,startLoading:u}=a(),{errors:x,getFieldProps:m,handleSubmit:f,values:v,setFieldValue:p,touched:j}=(0,W.Wx)({enableReinitialize:!0,initialValues:{title:s?s.title:"",description:s?s.description:"",status:s?s.status:"",estimate:s?s.estimate:void 0},validationSchema:Z.Ik().shape({title:Z.Yj().required("please enter job title")}),onSubmit:async e=>{const{...t}=e;try{let e={...t,workspace_id:l};o||(e.status="in_progress"),u(),await(0,h.A)({url:o?`/jobs/${s.id}`:"/jobs",method:o?"PUT":"POST",data:e}),K.oR.success(o?"Job has been updated successfully":"Job has been created successfully"),n&&n(),c()}catch(i){c()}}}),b=!v.title;return(0,g.jsxs)("form",{onSubmit:f,className:"flex flex-col gap-y-5 px-4",children:[(0,g.jsx)(vt,{title:"Title",children:(0,g.jsx)(Y.A,{...m("title"),hasError:!!j.title&&!!x.title,helperText:!!j.title&&x.title,placeholder:"Enter Job Title"})}),(0,g.jsx)(vt,{title:"Estimate Time (Hours)",children:(0,g.jsx)("div",{className:"flex items-center gap-x-4 justify-between",children:(0,g.jsx)(Y.A,{...m("estimate"),hasError:!!j.estimate&&!!x.estimate,helperText:!!j.estimate&&x.estimate,placeholder:"Estimate time"})})}),o&&(0,g.jsx)(vt,{title:"Status",children:(0,g.jsx)(un,{onSelect:e=>p("status",e.value),defaultValue:null===(t=vn.find((e=>e.value===(null===v||void 0===v?void 0:v.status))))||void 0===t?void 0:t.title,items:vn})}),(0,g.jsx)(vt,{title:"Description",children:(0,g.jsx)(mn,{...m("description"),placeholder:"Enter job Description",rows:5,className:"resize-none"})}),(0,g.jsxs)("div",{className:"flex flex-row justify-end gap-x-2",children:[(0,g.jsx)(L.A,{variant:"outline",className:"w-full",onClick:r,children:"Close"}),o&&(0,g.jsx)(fn,{jobId:s.id,onDelete:i}),(0,g.jsx)(L.A,{type:"submit",className:"w-full",startIcon:(0,g.jsx)(ft.A,{size:16}),loading:d,disabled:b,children:(o?"Update":"Create")+" Job"})]})]})};function pn(e){let{job:t,fetchAgain:s}=e;return(0,g.jsx)(B,{trigger:e=>(0,g.jsx)(ze,{title:"Edit Job",children:(0,g.jsx)(ee.A,{onClick:e,className:"text-black/60 hover:text-black w-8 h-8",children:(0,g.jsx)(Ue.A,{size:16})})}),className:"w-[440px]",children:(e,l)=>(0,g.jsx)(hn,{onClose:l,defaultValue:t,onCreated:()=>{s&&s(),l()},onDelete:()=>{s&&s(),l()}})})}function gn(e){let{variant:t="info",label:s,alpha:l="0.1"}=e,n="rgba(0,0,0,1)",i=`rgba(0,0,0,${l})`;switch(t){case"success":i="rgba(56,142,60,1)",n=`rgba(56,142,60,${l})`;break;case"info":i="rgba(2,136,209,1)",n=`rgba(2,136,209,${l})`;break;case"warning":i="rgba(243, 156, 18, 1)",n=`rgba(243, 156, 18, ${l})`;break;case"error":i="rgba(230,74,25,1)",n=`rgba(230,74,25,${l})`;break;default:i="rgba(0,0,0,1)",n=`rgba(0,0,0,${l})`}return(0,g.jsx)("div",{className:"w-auto inline-flex py-[4px] px-[10px] rounded-[32px] text-[12px] font-medium",style:{backgroundColor:n,color:i},children:s})}const jn=e=>{let{status:t}=e,s="default",l="";switch(t){case"in_progress":l="In progress",s="info";break;case"paused":l="Paused",s="warning";break;case"completed":l="Completed",s="success"}return(0,g.jsx)(gn,{variant:s,label:l})};var bn=s(3279);function wn(e){let{job:t,onStart:s}=e;const{startLoading:l,stopLoading:n,isLoading:i}=a();return(0,g.jsx)(ee.A,{onClick:()=>{l(),h.A.put(`/jobs/${t.id}`,{status:"in_progress"}).then((e=>{K.oR.success("Job has been started"),n(),s&&s()})).catch((()=>{n()}))},disabled:i,className:"text-black/60 hover:text-black w-8 h-8",children:(0,g.jsx)(bn.A,{className:"text-blue-600",size:16})})}var yn=s(4007);function Nn(e){let{job:t,onPause:s}=e;const{startLoading:l,stopLoading:n,isLoading:i}=a();return(0,g.jsx)(ee.A,{onClick:()=>{l(),h.A.put(`/jobs/${t.id}`,{status:"paused"}).then((e=>{K.oR.success("Job has been stopped"),n(),s&&s()})).catch((()=>{n()}))},disabled:i,className:"text-black/60 hover:text-black w-8 h-8",children:(0,g.jsx)(yn.A,{className:"text-yellow-600",size:16})})}function kn(e){let{job:t,onDelete:s}=e;const{startLoading:l,stopLoading:n,isLoading:i}=a();return(0,g.jsx)(ee.A,{onClick:()=>{l(),h.A.delete(`/jobs/${t.id}`).then((e=>{K.oR.success("Job has been deleted"),s&&s(),n()})).catch((()=>{n()}))},disabled:i,className:"text-black/60 hover:text-black w-8 h-8",children:(0,g.jsx)(dt.A,{className:"text-red-600",size:16})})}var An=s(2054);function Cn(e){let{job:t,onDone:s}=e;const{startLoading:l,stopLoading:n,isLoading:i}=a();return(0,g.jsx)(ee.A,{onClick:()=>{l(),h.A.put(`/jobs/${t.id}`,{status:"completed"}).then((e=>{K.oR.success("Job has been completed"),s&&s(),n()})).catch((()=>{n()}))},disabled:i,className:"text-black/60 hover:text-black w-8 h-8",children:(0,g.jsx)(An.A,{className:"text-green-600",size:16})})}function Sn(e){let{job:t,onPause:s,onDelete:l,onStart:n,onDone:i}=e;return(0,g.jsxs)("div",{className:"flex flex-row items-center",children:["paused"===t.status&&(0,g.jsx)(wn,{onStart:n,job:t}),"in_progress"===t.status&&(0,g.jsx)(Nn,{onPause:s,job:t}),(0,g.jsx)(kn,{job:t,onDelete:l}),(0,g.jsx)(Cn,{job:t,onDone:i})]})}const _n=e=>{let{item:t,mutate:s}=e;return(0,g.jsxs)("div",{className:"flex flex-col gap-y-2 items-start w-full p-4 border rounded-md shadow-md",children:[(0,g.jsxs)("div",{className:"flex w-full justify-between flex-row items-center gap-x-2",children:[(0,g.jsx)("strong",{className:"italic text-base text-black/[0.78]",children:t.title}),(0,g.jsxs)("div",{className:"flex flex-row items-center",children:[(0,g.jsx)(Sn,{job:t,onPause:s,onStart:s,onDelete:s,onDone:s}),(0,g.jsx)(pn,{job:t,fetchAgain:s})]})]}),(0,g.jsx)("p",{className:"text-sm text-black/60",children:(0,f.ai)(t.description,100)}),(0,g.jsx)("div",{className:"flex w-full items-center justify-between mt-2 ",children:(0,g.jsx)(jn,{status:t.status})})]})},Rn=e=>{let{onCreated:t,workspaceId:s}=e;return void 0===s?null:(0,g.jsx)(B,{trigger:e=>(0,g.jsx)(L.A,{startIcon:(0,g.jsx)(X.A,{}),onClick:e,children:"Add Job"}),className:"w-[450px]",children:(e,l)=>(0,g.jsx)(hn,{workspaceId:s,onClose:l,onCreated:()=>{t&&t(),l()}})})},En=e=>{var t;const{workspace_id:s}=b(),{data:l,isLoading:i,mutate:a}=(0,n.g)((0,f.sB)("/users/me/jobs",{workspace_id:s}),void 0,{isPaused:()=>void 0===s});let r=null!==(t=l&&(null===l||void 0===l?void 0:l.data))&&void 0!==t?t:[],o=(0,g.jsx)("div",{className:"flex flex-col w-full gap-y-2 max-h-[350px] py-2 overflow-auto",children:r.map(((e,t)=>(0,g.jsx)(_n,{mutate:a,item:e},t+1)))});const d=void 0===l||i;return d||0!==r.length||(o=(0,g.jsx)("span",{className:"w-full font-medium text-center py-4",children:"There is no job to show!"})),d?(0,g.jsx)(Te.A,{}):(0,g.jsxs)("div",{className:"flex w-full flex-col gap-y-6 items-end",children:[o,(0,g.jsx)(Rn,{workspaceId:s,onCreated:a})]})};function zn(){return(0,g.jsx)(Kl,{trigger:e=>(0,g.jsx)(L.A,{onClick:e,startIcon:(0,g.jsx)(ln.A,{size:22}),className:"bg-white hover:bg-white text-black rounded-xl",children:"Jobs"}),children:(e,t,s)=>(0,g.jsx)(Zl,{onClose:s,title:"Jobs",width:400,zIndex:e.zIndex,top:e.top,left:e.left,children:(0,g.jsx)(En,{})})})}function Ln(){return(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-2",children:[(0,g.jsx)(Xl,{}),(0,g.jsx)(sn,{}),(0,g.jsx)(zn,{})]})}var Tn=s(8899);function Pn(e){let{trigger:t,afterDesc:s,open:l=!1,isPortal:n=!0,...a}=e;const[r,o]=(0,i.useState)(l),d=()=>o(!0),c=()=>{o(!1),null!==a&&void 0!==a&&a.onClose&&a.onClose()},u=()=>{null!==a&&void 0!==a&&a.onSubmit&&a.onSubmit()};(0,de.A)(ue.X.closePrompt,(()=>{c()}));let x=null;return n&&t&&(x=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)($,{asChild:!0,children:t(d)}),(0,g.jsx)(U,{className:"sm:max-w-[425px] pt-12",children:(0,g.jsx)(Hs,{...a,onSubmit:u,onClose:c,afterDesc:s})})]})),n||(x=(0,g.jsxs)(g.Fragment,{children:[t?(0,g.jsx)($,{asChild:!0,children:t(d)}):null,(0,g.jsx)(V,{className:"z-10",onClick:c}),(0,g.jsx)("div",{className:"fixed left-[50%] top-[50%] z-20 w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg sm:rounded-lg",children:(0,g.jsx)(Hs,{...a,onSubmit:u,onClose:c})})]})),(0,g.jsx)(I,{open:r,onOpenChange:o,children:x})}function Dn(e){var t,s;let{item:l,onPick:n,isSelected:i}=e;const a=(0,f.O1)(l),r=null===l||void 0===l?void 0:l.username;let o="flex flex-row items-center gap-x-4 px-4 py-2 cursor-pointer";return o+=i?" bg-black/[.06] hover:bg-black/[.03]":" hover:bg-black/[.03]",(0,g.jsxs)("div",{onClick:()=>n&&n(l),className:o,children:[(0,g.jsx)(me.A,{src:null!==(t=null===(s=l.avatar)||void 0===s?void 0:s.url)&&void 0!==t?t:void 0,title:null===a||void 0===a?void 0:a[0]}),(0,g.jsxs)("div",{className:"flex items-start flex-col",children:[(0,g.jsx)("strong",{children:a}),(0,g.jsx)("span",{children:r})]})]})}function In(e){let{items:t,onPick:s,defaultSelectedId:l}=e;return 0===t.length?null:(0,g.jsx)("div",{className:"py-2 flex flex-col overflow-hidden max-h-[300px] overflow-y-auto",children:t.map((e=>(0,g.jsx)(Dn,{item:e,onPick:s,isSelected:l===(null===e||void 0===e?void 0:e.id)},e.id)))})}function $n(e){let{onPick:t,afterTitle:s,defaultSelectedId:l}=e;const[a,r]=(0,i.useState)();(0,i.useEffect)((()=>{void 0===l&&r(void 0)}),[l]);const[o,d]=(0,i.useState)(""),{data:c,isLoading:u}=(0,n.g)("/users/search",{method:"POST",data:{search:o},key:`/users/search/${o}`,isFetch:""!==o}),x=void 0!==c?null===c||void 0===c?void 0:c.data:[];let m=null;return x.length>0&&(m=(0,g.jsx)(In,{items:x,onPick:e=>{d(""),r(e),t&&t(e)},defaultSelectedId:l})),0===x.length&&void 0!==c&&(m=(0,g.jsx)("strong",{className:"p-4 shadow-md rounded-lg text-sm",children:"Could not find a Cotopia account "+(o?`matching "${o}"`:"")})),u&&(m=(0,g.jsx)(Te.A,{})),(0,g.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,g.jsx)("p",{className:"text-black/60",children:"Search by username, full name, or email"}),!!s&&s,void 0===a&&(0,g.jsx)(Y.A,{placeholder:"Find people",onChange:e=>d(e.target.value),value:o}),m]})}const Mn=(0,s(435).F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),On=i.forwardRef(((e,t)=>{let{className:s,variant:l,...n}=e;return(0,g.jsx)("div",{ref:t,role:"alert",className:(0,f.cn)(Mn({variant:l}),s),...n})}));On.displayName="Alert";const Vn=i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)("h5",{ref:t,className:(0,f.cn)("mb-1 font-medium leading-none tracking-tight",s),...l})}));Vn.displayName="AlertTitle";const Un=i.forwardRef(((e,t)=>{let{className:s,...l}=e;return(0,g.jsx)("div",{ref:t,className:(0,f.cn)("text-sm [&_p]:leading-relaxed",s),...l})}));Un.displayName="AlertDescription";var Fn=s(4459);function Hn(e){let{user:t,onDelete:s}=e;const l=(0,f.O1)(t);return(0,g.jsxs)(On,{children:[(0,g.jsx)(Fn.A,{className:"h-4 w-4"}),(0,g.jsx)(Vn,{children:l}),(0,g.jsx)(Un,{children:`You are inviting ${l} to the room.`}),(0,g.jsx)(ee.A,{className:"absolute top-1 right-1",onClick:s,children:(0,g.jsx)(dt.A,{className:"text-black/60",size:20})})]})}var Jn=s(5270),Gn=s.n(Jn),qn=s(2313);let Bn;function Yn(e){let{code:t}=e;const[s,l]=(0,i.useState)(!1);return(0,g.jsx)(ee.A,{onClick:()=>{Gn()(t),l(!0),clearTimeout(Bn),Bn=setTimeout((()=>{l(!1)}),2e3)},className:"text-white !bg-black !rounded-md",children:s?(0,g.jsx)(Ge.A,{size:16}):(0,g.jsx)(qn.A,{size:16})})}function Wn(e){let{code:t,onCopy:s,onCancel:l}=e;const n=`${Ut.c.domain}/invite/${t}`;return(0,g.jsx)(I,{open:!0,children:(0,g.jsxs)(U,{className:"sm:max-w-md [&_.opacity-70]:!hidden",children:[(0,g.jsxs)(F,{children:[(0,g.jsx)(J,{children:"Share link"}),(0,g.jsx)(G,{children:"Anyone who has this link will be join to this room."})]}),(0,g.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,g.jsx)(Y.A,{defaultValue:n,readOnly:!0}),(0,g.jsx)(Yn,{code:n})]}),(0,g.jsx)(H,{className:"sm:justify-start",children:(0,g.jsx)(O,{asChild:!0,onClick:l,children:(0,g.jsx)(Nt.$,{type:"button",variant:"secondary",children:"Close"})})})]})})}function Xn(){const[e,t]=(0,i.useState)(),{room_id:s}=b(),{startLoading:l,stopLoading:n,isLoading:r}=a(),[o,d]=(0,i.useState)();return(0,g.jsxs)(g.Fragment,{children:[void 0!==o&&(0,g.jsx)(Wn,{code:o.code,onCancel:()=>d(void 0),onCopy:()=>{}}),void 0===o&&(0,g.jsx)(Pn,{onClose:()=>{d(void 0)},onSubmit:()=>{void 0!==s&&(void 0!==e?(l(),h.A.post("/invites",{model:"room",model_id:s,user_id:e.id}).then((e=>{d(e.data.data),t(void 0),n()})).catch((e=>{n()}))):K.oR.error("Please select at least a user to invite"))},title:"Invite user",description:"",afterDesc:(0,g.jsx)(g.Fragment,{children:(0,g.jsx)($n,{defaultSelectedId:null===e||void 0===e?void 0:e.id,onPick:t,afterTitle:void 0!==e&&(0,g.jsx)(Hn,{user:e,onDelete:()=>t(void 0)})})}),trigger:e=>(0,g.jsx)(L.A,{onClick:e,loading:r,startIcon:(0,g.jsx)(Tn.A,{}),className:"bg-white hover:bg-white text-black rounded-xl",children:"Invite"})})]})}var Kn=s(6873),Zn=s(6021),Qn=s(797),ei=s(2043),ti=s(8702);const si=i.forwardRef(((e,t)=>{let{className:s,value:l,...n}=e;return(0,g.jsx)(ti.bL,{ref:t,className:(0,f.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...n,children:(0,g.jsx)(ti.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(l||0)}%)`}})})}));function li(e){let{image:t}=e;return(0,g.jsx)("div",{className:"w-full uploader-content rounded-full h-[120px] bg-cover cursor-pointer bg-center",style:{backgroundImage:`url(${t.url})`}})}si.displayName=ti.bL.displayName;var ni=s(3002),ii=s(8487);const ai={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NEXT_PUBLIC_API_URL;function ri(e){let{document:t}=e;return(0,g.jsx)("div",{className:"uploader-content w-full h-[120px] rounded-full bg-cover cursor-pointer bg-white/[.05]",children:(0,g.jsxs)("div",{className:"flex flex-col h-full gap-y-4 items-center justify-center",children:[(0,g.jsx)(ni.A,{}),(0,g.jsx)("span",{className:"whitespace-pre-wrap w-[70%] text-ellipsis overflow-hidden",children:t.path.slice(0,5)}),(0,g.jsx)(r.N_,{to:`${ai}${t.url}`,children:(0,g.jsxs)(Nt.$,{type:"button",children:[(0,g.jsx)(ii.A,{className:"mr-2",size:16}),"Open File"]})})]})})}const oi={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NEXT_PUBLIC_API_URL;function di(e){let{video:t}=e;return(0,g.jsx)("div",{className:"w-full uploader-content h-[120px] bg-cover rounded-full cursor-pointer bg-white/[.05]",children:(0,g.jsxs)("div",{className:"flex flex-col h-full gap-y-4 items-center justify-center",children:[(0,g.jsx)(Me.A,{}),(0,g.jsx)("span",{className:"whitespace-pre-wrap w-[70%] text-ellipsis overflow-hidden",children:t.path.slice(0,5)}),(0,g.jsx)(r.N_,{to:`${oi}${t.url}`,target:"_blank",children:(0,g.jsx)(Nt.$,{type:"button",children:"Open Video"})})]})})}const ci=["image/webp","image/jpg","image/jpeg","image/png","image/svg+xml"],ui=["video/mp4","video/mpeg"],xi=["text/plain","application/vnd.openxmlformats-","application/msword"];function mi(e){let{file:t}=e;return ci.includes(t.mime_type)?(0,g.jsx)(li,{image:t}):xi.includes(t.mime_type)?(0,g.jsx)(ri,{document:t}):ui.includes(t.mime_type)?(0,g.jsx)(di,{video:t}):null}function fi(e){let{label:t,defaultMedia:s,onUpload:l,onUploadList:n,onDelete:r,upload_text:o,isMultiple:d,hasWatermark:c=!0,uploaderClass:u,resetAfterUpload:x=!1}=e;const[m,v]=(0,i.useState)(null);(0,i.useEffect)((()=>{v(null!==s&&void 0!==s?s:null)}),[s]);const p=(0,i.useCallback)((async e=>{if(e.preventDefault(),e.stopPropagation(),v(null),s)try{await h.A.delete(`/files/${s.id}`)}catch(e){}r&&r()}),[r,s]),{startLoading:j,stopLoading:b,isLoading:w}=a(),y=async e=>{if(!e)return void K.oR.error("Please insert valid file");const t=new FormData;t.append("file",e),k(1);const s=await(0,h.A)({url:(0,f.sB)("/files",{watermark:c}),method:"POST",data:t,onUploadProgress:e=>{var t;const s=100*e.loaded/(null!==(t=null===e||void 0===e?void 0:e.total)&&void 0!==t?t:0);k(parseInt(s.toFixed(2)))}});return x||v(s.data.data),s},[N,k]=(0,i.useState)(0);let A=(0,g.jsxs)("div",{className:`uploader-content relative w-full h-[120px] flex flex-col items-center justify-center rounded-full bg-black/[.05] hover:bg-black/10 cursor-pointer ${u}`,children:[(0,g.jsxs)("div",{className:"flex flex-col gap-y-4 items-center",children:[(0,g.jsx)(Qn.A,{}),!!o&&(0,g.jsx)("span",{children:o})]}),(0,g.jsx)("input",{type:"file",className:"absolute top-0 left-0 w-full h-full opacity-0 cursor-pointer",onChange:async e=>{if(null===e.target.files)return;if(e.target.files.length>1){j();let l=[];try{for(let n of e.target.files){var t,s;const e=await y(n);null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.data&&(l=[...l,null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.data])}b()}catch(e){b()}return void(n&&l.length>0&&(n(l),K.oR.success("All files uploaded")))}const i=e.target.files[0];try{const e=await y(i);l&&e&&(K.oR.success("File has been uploaded succesfully!"),l(e.data.data))}catch(e){}},multiple:null!==d&&void 0!==d&&d})]});return m&&!x&&(A=(0,g.jsx)(mi,{file:m})),w&&(A=(0,g.jsx)("div",{className:"uploader-content relative w-full h-[240px] flex flex-col items-center justify-center rounded-md bg-black/[.05]",children:(0,g.jsx)(ei.A,{className:"animate-spin"})})),(0,g.jsxs)("div",{className:"flex flex-col w-full gap-y-2",children:[!!t&&(0,g.jsx)("strong",{children:t}),(0,g.jsxs)("div",{className:"relative flex flex-col gap-y-2 w-full",children:[m&&(0,g.jsx)(Nt.$,{className:"absolute top-2 left-2",size:"icon",onClick:p,type:"button",children:(0,g.jsx)(dt.A,{})}),A,N>0&&N<100&&(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-4",children:[(0,g.jsx)(si,{className:"!bg-white/10 [&_.bg-primary]:!bg-white/10 h-[6px]",value:N}),(0,g.jsx)("strong",{className:"text-white",children:`${N}%`})]})]})]})}function vi(){var e;const{user:t}=(0,ce.A)();return(0,g.jsx)("div",{className:"w-[120px] max-w-full",children:(0,g.jsx)(fi,{defaultMedia:null!==(e=null===t||void 0===t?void 0:t.avatar)&&void 0!==e?e:void 0,onUpload:e=>{h.A.put("/users/update",{avatar_id:e.id}).then((e=>{}))},onDelete:()=>{h.A.put("/users/update",{avatar_id:void 0}).then((e=>{}))},label:"Avatar"})})}function hi(){var e;const{user:t}=(0,ce.A)(),{isSubmitting:s,touched:l,errors:n,getFieldProps:i,handleSubmit:a}=(0,W.Wx)({enableReinitialize:!0,initialValues:{name:null!==(e=null===t||void 0===t?void 0:t.name)&&void 0!==e?e:""},validationSchema:Z.Ik().shape({name:Z.Yj().required("Name is required")}),onSubmit:(e,t)=>{t.setSubmitting(!0),h.A.put("/users/update",{name:e.name}).then((e=>{t.setSubmitting(!1),K.oR.success("Your information has been updated.")})).catch((e=>{t.setSubmitting(!1)}))}});return(0,g.jsxs)("form",{onSubmit:a,className:"flex flex-col gap-y-16 items-start",children:[(0,g.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,g.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,g.jsx)("strong",{children:"You can change your user information here"}),(0,g.jsx)("p",{className:"text-black/60 text-base",children:"Be careful, changing information here effects your presence everywhere."})]}),(0,g.jsx)(Y.A,{...i("name"),placeholder:"Enter the name",label:"Your name",hasError:!!l.name&&!!n.name,helperText:!!l.name&&!!n.name&&n.name})]}),(0,g.jsx)(L.A,{loading:s,type:"submit",className:"w-[100px] max-w-full",children:"Save"})]})}function pi(){return(0,g.jsxs)("div",{className:"flex flex-col gap-y-4 items-start",children:[(0,g.jsx)(vi,{}),(0,g.jsx)(hi,{})]})}function gi(e){let{title:t,...s}=e;return(0,g.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,g.jsx)("strong",{children:t}),(0,g.jsx)(rt,{...s})]})}var ji=s(2617);function bi(){const e=c(),t=(0,d.jL)();return(0,g.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,g.jsx)(gi,{title:"User join/left has sound",checked:e.sounds.userJoinLeft,onCheckedChange:()=>t((0,ji.y)({key:"userJoinLeft"}))}),(0,g.jsx)(gi,{title:"Message incoming has sound",checked:e.sounds.messageIncoming,onCheckedChange:()=>t((0,ji.y)({key:"messageIncoming"}))})]})}var wi=s(9451);function yi(){const e=(0,d.jL)();return(0,g.jsx)(L.A,{onClick:()=>{e((0,wi.ri)())},variant:"destructive",className:"text-white !px-4",children:"Logout"})}function Ni(){return(0,g.jsx)("div",{className:"p-6 flex flex-col gap-y-4",children:(0,g.jsx)(_,{title:(0,g.jsx)(yi,{}),dividerBetweenContentAndTabs:!0,defaultValue:"additional-information",items:[{icon:(0,g.jsx)(Kn.A,{}),content:(0,g.jsx)(pi,{}),value:"additional-information"},{icon:(0,g.jsx)(Zn.A,{}),content:(0,g.jsx)(bi,{}),value:"global-settings"}]})})}function ki(e){let{size:t="large"}=e;const{user:s}=(0,ce.A)();if(!s)return null;let l=(0,f.O1)(s),n="cursor-pointer";return"normal"===t&&(n+=" w-[32px] h-[32px]"),(0,g.jsx)(B,{trigger:e=>{var t,i;return(0,g.jsx)(me.A,{src:null!==(t=null===s||void 0===s||null===(i=s.avatar)||void 0===i?void 0:i.url)&&void 0!==t?t:void 0,title:null===l||void 0===l?void 0:l[0],className:n,onClick:e})},className:"w-[640px]",children:(e,t)=>(0,g.jsx)(Ni,{})})}function Ai(){return(0,g.jsx)(ki,{size:"normal"})}var Ci=s(9493);function Si(){const{workspace_id:e}=b(),t=(0,p.Zp)(),{startLoading:s,stopLoading:l,isLoading:n}=a();return(0,g.jsx)(ee.A,{disabled:n,onClick:()=>{s(),h.A.get("/rooms/leave").then((s=>{t(`/workspaces/${e}`),l()})).catch((e=>{l()}))},className:"text-red-600",children:(0,g.jsx)(Ci.A,{})})}var _i=s(7365);function Ri(e){let{item:t,room_id:s,workspace_id:l}=e;const{isLoading:n,startLoading:i,stopLoading:r}=a();return(0,g.jsx)(ze,{title:t.title,triggerClassName:"w-full",children:(0,g.jsxs)("div",{className:"w-full h-[115px] relative cursor-pointer hover:opacity-80",onClick:async()=>{i();try{const e=(await h.A.post("/files",{path:t.source})).data.data;await h.A.put(`/rooms/${s}`,{background_id:e.id}),r()}catch(e){r()}},children:[(0,g.jsx)("img",{src:t.source,alt:t.title}),n&&(0,g.jsx)(Te.A,{className:"absolute top-[50%] left-[50%] translate-x-[-50%] translate-y-[-50%] justify-center"})]})})}function Ei(e){let{room_id:t,workspace_id:s}=e;const{data:l,isLoading:i}=(0,n.L)("/api/room/template/gallery"),a=l||[];let r=(0,g.jsx)("div",{className:"grid grid-cols-12 gap-2",children:a.map((e=>(0,g.jsx)("div",{className:"col-span-6 md:col-span-3",children:(0,g.jsx)(Ri,{item:e,room_id:t,workspace_id:s})},e.id)))});return 0===a.length&&(r=(0,g.jsx)("span",{children:"There is no gallery template yet."})),i&&(r=(0,g.jsx)(Te.A,{})),(0,g.jsx)("div",{className:"mt-2",children:r})}function zi(){const{room_id:e,workspace_id:t}=b();return e&&t?(0,g.jsx)(_,{title:"Background",titleClassName:"text-base text-gray-700",defaultValue:"gallery",items:[{title:"Gallery",value:"gallery",content:(0,g.jsx)(Ei,{room_id:e,workspace_id:t})},{title:"Upload",value:"upload",content:(0,g.jsx)(g.Fragment,{children:"This feature will be ready in the soon future."})}]}):null}function Li(){return(0,g.jsx)(g.Fragment,{children:"Permissions"})}function Ti(){return(0,g.jsx)(_,{title:"Room Settings",titleClassName:"text-xl",items:[{title:"Background",value:"background",content:(0,g.jsx)(zi,{})},{title:"Permissions",value:"permissions",content:(0,g.jsx)(Li,{})}],className:"pt-6",dividerBetweenContentAndTabs:!0})}function Pi(){return(0,g.jsx)(B,{trigger:e=>(0,g.jsx)(ee.A,{onClick:e,className:"text-black",children:(0,g.jsx)(_i.A,{})}),className:"w-[800px]",children:(e,t)=>(0,g.jsx)(Ti,{})})}function Di(){return(0,g.jsxs)("div",{className:"flex flex-row items-center bg-white rounded-xl px-2",children:[(0,g.jsx)(Pi,{}),(0,g.jsx)(Ai,{}),(0,g.jsx)(Si,{})]})}var Ii=s(2983);function $i(){var e;const{openSidebar:t,closeSidebar:s,sidebar:l}=b(),n=(0,d.GV)((e=>e.room)),i=null!==(e=null===n||void 0===n?void 0:n.messages_count)&&void 0!==e?e:{room:[],objects:{}},a=i.room,r=null===Object||void 0===Object?void 0:Object.values(i.directs).flatMap((e=>e)),o=a.length+r.length;return(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)(he,{count:o,className:"absolute right-[1px] text-xs top-[1px] z-[2] ",size:"small"}),(0,g.jsx)(ee.A,{className:"text-black",onClick:()=>{l?s():t((0,g.jsx)(g.Fragment,{}))},children:(0,g.jsx)(Ii.A,{})})]})}function Mi(e){let{onClick:t}=e;return Dl("Escape",t),(0,g.jsx)(ee.A,{className:"text-black",onClick:t,children:(0,g.jsx)(D.A,{size:20})})}function Oi(){const{sidebar:e,closeSidebar:t}=b();return(0,g.jsx)("div",{className:"flex flex-row items-center bg-white rounded-xl px-2",children:e?(0,g.jsx)(Mi,{onClick:t}):(0,g.jsx)(g.Fragment,{children:(0,g.jsx)($i,{})})})}function Vi(e){let{initialSeconds:t,children:s}=e;const[l,n]=(0,i.useState)(t);return(0,i.useEffect)((()=>{void 0!==t&&n(t)}),[t]),(0,i.useEffect)((()=>{const e=setInterval((()=>{n((e=>e+1))}),1e3);return()=>clearInterval(e)}),[]),(0,g.jsx)(g.Fragment,{children:s((0,f.Gk)((null!==l&&void 0!==l?l:0)/60))})}var Ui=s(7026);const Fi=i.forwardRef(((e,t)=>{let{className:s,children:l,...n}=e;return(0,g.jsxs)(Ui.bL,{ref:t,className:(0,f.cn)("relative overflow-hidden",s),...n,children:[(0,g.jsx)(Ui.LM,{className:"h-full w-full rounded-[inherit]",children:l}),(0,g.jsx)(Hi,{}),(0,g.jsx)(Ui.OK,{})]})}));Fi.displayName=Ui.bL.displayName;const Hi=i.forwardRef(((e,t)=>{let{className:s,orientation:l="vertical",...n}=e;return(0,g.jsx)(Ui.VM,{ref:t,orientation:l,className:(0,f.cn)("flex touch-none select-none transition-colors","vertical"===l&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===l&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...n,children:(0,g.jsx)(Ui.lr,{className:"relative flex-1 rounded-full bg-border"})})}));function Ji(e){let{rank:t}=e,s="rounded-full w-6 h-6 flex flex-col items-center justify-center text-xs";return s+=1===t?" bg-yellow-600 text-white":2===t?" bg-gray-400 text-white":3===t?" bg-orange-800 text-white":" bg-blue-100",(0,g.jsx)("div",{className:s,children:t})}Hi.displayName=Ui.VM.displayName;var Gi=s(7876),qi=s(3546),Bi=s(712);function Yi(e){let{children:t,className:s,variant:l,duration:n=.4,delay:a=0,yOffset:r=6,inView:o=!1,inViewMargin:d="-50px",blur:c="6px"}=e;const u=(0,i.useRef)(null),x=(0,Gi.W)(u,{once:!0,margin:d}),m=!o||x,f=l||{hidden:{y:r,opacity:0,filter:`blur(${c})`},visible:{y:-r,opacity:1,filter:"blur(0px)"}};return(0,g.jsx)(qi.N,{children:(0,g.jsx)(Bi.P.div,{ref:u,initial:"hidden",animate:m?"visible":"hidden",exit:"hidden",variants:f,transition:{delay:.04+a,duration:n,ease:"easeOut"},className:s,children:t})})}function Wi(){var e;const{workspace_id:t}=b(),{user:s}=(0,ce.A)(),{data:l}=(0,n.g)(`/workspaces/${t}/leaderboard`),i=null!==(e=null===l||void 0===l?void 0:l.data)&&void 0!==e?e:[];let a=(0,g.jsx)(g.Fragment,{children:i.sort(((e,t)=>t.sum_minutes-e.sum_minutes)).map(((e,t)=>{var l,n,i,a,r,o,d;const c=e.user.id===(null===s||void 0===s?void 0:s.id);let u="flex flex-row items-center justify-between p-2 border-b last:border-0";c&&(u+=" bg-sky-300");const x="online"===(null===e||void 0===e||null===(l=e.user)||void 0===l?void 0:l.status)&&null!==(null===(n=e.user)||void 0===n?void 0:n.room_id)||c;return(0,g.jsxs)(Yi,{inView:!0,className:u,delay:.05+.05*t,children:[(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-2",children:[(0,g.jsx)(Ji,{rank:t+1}),(0,g.jsx)(Ns,{title:null===(i=e.user)||void 0===i?void 0:i.name,src:null===e||void 0===e||null===(a=e.user)||void 0===a||null===(r=a.avatar)||void 0===r?void 0:r.url}),(0,g.jsx)("span",{className:"text-xs",children:null!==(o=null===(d=e.user)||void 0===d?void 0:d.name)&&void 0!==o?o:"-"})]}),(0,g.jsx)("div",{children:x?(0,g.jsx)(Vi,{initialSeconds:60*e.sum_minutes,children:e=>(0,g.jsx)("strong",{className:"text-xs",children:e})}):(0,g.jsx)("span",{className:"text-xs opacity-85",children:(0,f.Gk)(e.sum_minutes)})})]},t)}))});return(0,g.jsx)(Fi,{className:"h-72 flex flex-col gap-y-4 w-full",children:a})}var Xi=s(5088);function Ki(e){let{isLoading:t,onClick:s,defaultSeconds:l}=e;return(0,g.jsxs)(L.A,{loading:t,className:"relative bg-white hover:bg-white text-black rounded-xl !pr-6",startIcon:(0,g.jsx)(Xi.A,{}),onClick:s,children:[(0,g.jsx)("div",{className:"absolute top-2 right-2 w-2 h-2 bg-red-600 rounded-full animate-pulse"}),(0,g.jsx)(Vi,{initialSeconds:l,children:e=>(0,g.jsx)("span",{className:"min-w-[60px]",children:e})})]})}function Zi(){const[e,t]=(0,i.useState)(),{startLoading:s,stopLoading:l,isLoading:n}=a();return(0,i.useEffect)((()=>{s(),h.A.get((0,f.sB)("/users/activities",{period:"today"})).then((e=>{const s=e.data.data;t(60*s),l()})).catch((e=>{l()}))}),[]),(0,g.jsx)(Kl,{trigger:t=>(0,g.jsx)(Ki,{defaultSeconds:null!==e&&void 0!==e?e:0,onClick:t,isLoading:n}),children:(e,t,s)=>(0,g.jsx)(Zl,{...e,onClose:s,title:"Leaderboard",width:300,children:(0,g.jsx)(Wi,{})})})}function Qi(){return(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-2",children:[(0,g.jsx)(Zi,{}),(0,g.jsx)(Xn,{}),(0,g.jsx)(Di,{}),(0,g.jsx)(Oi,{})]})}function ea(e){let{height:t=24}=e;return(0,g.jsx)("div",{className:"w-[1px] bg-black/10",style:{height:t}})}var ta=s(7800);function sa(e){let{files:t,isMultiple:s,onChange:l,uploaderClass:n}=e;const[a,r]=(0,i.useState)(t);return(0,g.jsxs)("div",{className:"flex flex-row items-center gap-4 flex-wrap w-full",children:[(0,g.jsx)("div",{className:"w-[120px]",children:(0,g.jsx)(fi,{onUpload:e=>r((t=>{const s=[...t,e];return l&&l(s),s})),onUploadList:e=>r((t=>{const s=[...t,...e];return l&&l(s),s})),isMultiple:s,resetAfterUpload:!0,uploaderClass:n})}),(null===a||void 0===a?void 0:a.length)>0?null===a||void 0===a?void 0:a.map((e=>(0,g.jsx)("div",{className:"w-[120px]",children:(0,g.jsx)(fi,{defaultMedia:e,onDelete:()=>(e=>{r((t=>{const s=t.filter((t=>t.id!==e.id));return l&&l(s),s}))})(e),uploaderClass:n})},e.id))):null]})}function la(e){let{onSubmitted:t,model_id:s,model_type:l}=e;const{values:n,isSubmitting:i,touched:a,errors:r,getFieldProps:o,handleSubmit:d,setFieldValue:c}=(0,W.Wx)({enableReinitialize:!0,initialValues:{title:"",description:"",files:[]},validationSchema:Z.Ik().shape({description:Z.Yj().required("Report is required")}),onSubmit:(e,n)=>{const{files:i,...a}=e;n.setSubmitting(!0),h.A.post("/reports",{...a,files:i.map((e=>e.id)),model_id:s,model_type:l}).then((e=>{n.setSubmitting(!1),K.oR.success("Your report has been submitted."),t&&t()})).catch((e=>{n.setSubmitting(!1)}))}});return(0,g.jsx)("div",{className:"p-6 flex flex-col gap-y-4 w-full",children:(0,g.jsxs)("form",{onSubmit:d,className:"flex flex-col gap-y-16 items-start w-full",children:[(0,g.jsxs)("div",{className:"flex flex-col gap-y-4 w-full",children:[(0,g.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,g.jsx)("strong",{children:"Report a bug"}),(0,g.jsx)("p",{className:"text-black/60 text-base",children:"We will review your problem as soon as possible."})]}),(0,g.jsx)(Y.A,{...o("title"),placeholder:"Subject",hasError:!!a.title&&!!r.title,helperText:!!a.title&&!!r.title&&r.title}),(0,g.jsx)(mn,{...o("description"),placeholder:"Eg: updating profile doesn't work properly ...",hasError:!!a.description&&!!r.description,helperText:!!a.description&&!!r.description&&r.description}),(0,g.jsx)(vt,{title:"Attachments",children:(0,g.jsx)(sa,{isMultiple:!0,files:n.files,onChange:e=>c("files",e)})})]}),(0,g.jsx)(L.A,{loading:i,type:"submit",className:"w-[100px] max-w-full",children:"Submit"})]})})}function na(){const{room_id:e}=b();return(0,g.jsx)(B,{trigger:e=>(0,g.jsx)(ee.A,{onClick:e,className:"text-black",children:(0,g.jsx)(ta.A,{})}),className:"w-[640px]",children:(t,s)=>(0,g.jsx)(la,{onSubmitted:()=>{s()},model_id:""+e,model_type:"room"})})}var ia=s(3156),aa=s(8241),ra=s(5198),oa=s(4187);const da=()=>{const e=(0,v.FO)(),[t,s]=(0,i.useState)();(0,i.useEffect)((()=>{const t=setInterval((()=>{const t=Date.now();null===e||void 0===e||e.emit("ping",(()=>{const e=Date.now()-t;s(e)}))}),1e3);return()=>{clearInterval(t)}}),[]);let l="flex flex-row items-center gap-x-2",n=(0,g.jsx)(ia.A,{});return t&&(t<80?(l+=" text-green-500",n=(0,g.jsx)(ia.A,{})):t<140?(l+=" text-blue-500",n=(0,g.jsx)(aa.A,{})):t<200?(l+=" text-yellow-700",n=(0,g.jsx)(ra.A,{})):t>200&&(l+=" text-red-500",n=(0,g.jsx)(oa.A,{}))),(0,g.jsx)(ze,{title:`Ping (${t})`,children:(0,g.jsx)("div",{className:l,children:n})})};function ca(){return(0,g.jsxs)("div",{className:"flex flex-row items-center bg-white rounded-xl px-2 gap-x-2",children:[(0,g.jsx)(na,{}),(0,g.jsx)(ea,{}),(0,g.jsx)(da,{})]})}function ua(){return null}s(9394);function xa(){return null}var ma=s(4669);function fa(){const{openSidebar:e,sidebar:t,closeSidebar:s}=b();let l="text-black";return t&&(l+=" !bg-black/5"),(0,g.jsx)(ee.A,{className:l,onClick:()=>{t?s():e((0,g.jsx)(g.Fragment,{}))},children:(0,g.jsx)(ma.A,{size:20})})}function va(){return null}var ha=s(7178);function pa(){const e=(0,nl.f)(),[t,s]=(0,i.useState)(!1),l=(0,i.useCallback)((()=>{if(!e)return!1;const t=e.localParticipant.videoTrackPublications;for(let[e,s]of t.entries())if("screen_share"===s.source)return!0;return!1}),[e]),n=(0,i.useCallback)((async()=>{try{await e.localParticipant.setScreenShareEnabled(!1),s(!1)}catch(t){console.error("Error stopping screen share:",t)}}),[e]),a=(0,i.useCallback)((async()=>{if(e){if(t)return n();try{await e.localParticipant.setScreenShareEnabled(!0),s(!0)}catch(l){console.error("Error starting screen share:",l)}}}),[e,t,n]);return(0,de.A)(ue.X.stopMyScreenSharing,(()=>{n()})),(0,i.useEffect)((()=>{const e=l();s(e)}),[e,l]),(0,g.jsx)(ze,{title:t?"Stop screen sharing":"Share screen",children:(0,g.jsx)(ee.A,{className:"text-black",onClick:a,children:t?(0,g.jsx)(D.A,{size:20}):(0,g.jsx)(ha.A,{size:20})})})}var ga=s(6229);function ja(){var e;const{enableVideoAccess:t,disableVideoAccess:s,stream_loading:l}=Ha(),{localParticipant:n}=(0,Xs.C)(),i=n.getTrackPublication(Qs.CC.Source.Camera),a=null===i||void 0===i?void 0:i.track,r=null===(e=null===i||void 0===i?void 0:i.isMuted)||void 0===e||e;let o="Video Off";return null!==a&&void 0!==a&&a.isMuted&&(o="Video on"),(0,g.jsx)(ze,{title:o,children:(0,g.jsx)(ee.A,{disabled:l,className:"text-black",onClick:async()=>{if(!a)return n.setCameraEnabled(!0),t();r?(t(),a.unmute()):(s(),a.mute(),a.stop())},children:r?(0,g.jsx)(ga.A,{size:20}):(0,g.jsx)(Me.A,{size:20})})})}function ba(){var e;const{enableAudioAccess:t,disableAudioAccess:s,stream_loading:l}=Ha(),{localParticipant:n}=(0,Xs.C)(),i=n.getTrackPublication(Qs.CC.Source.Microphone),a=null===i||void 0===i?void 0:i.track,r=null===(e=null===i||void 0===i?void 0:i.isMuted)||void 0===e||e;let o="Mic Off";return null!==a&&void 0!==a&&a.isMuted&&(o="Mic on"),(0,g.jsx)(ze,{title:o,children:(0,g.jsx)(ee.A,{disabled:l,className:"text-black",onClick:async()=>{a&&(a.isMuted?(a.unmute(),t()):(a.mute(),a.stop(),s()))},children:r?(0,g.jsx)(xl.A,{size:20}):(0,g.jsx)(Oe.A,{size:20})})})}function wa(){return(0,g.jsxs)("div",{className:"flex flex-row items-center bg-white rounded-xl p-2",children:[(0,g.jsx)(ua,{}),(0,g.jsx)(va,{}),(0,g.jsx)(pa,{}),(0,g.jsx)(fa,{}),(0,g.jsx)(xa,{}),(0,g.jsx)(ja,{}),(0,g.jsx)(ba,{})]})}function ya(){const e=(0,Vt.VH)();return(0,g.jsxs)("div",{className:"zoom-actions transition-all hidden flex-col items-center gap-y-2 py-2",children:[(0,g.jsx)(ee.A,{onClick:()=>{e.zoomIn()},className:"text-black",children:(0,g.jsx)(X.A,{})}),(0,g.jsx)(ee.A,{onClick:()=>{e.zoomOut()},className:"text-black",children:(0,g.jsx)(lt.A,{})})]})}function Na(e){let{zoomPercent:t}=e;return(0,g.jsxs)("div",{className:"flex flex-col items-center bg-white rounded-xl px-2 py-1",children:[(0,g.jsx)(Je.A,{size:16}),(0,g.jsx)("span",{className:"min-w-[48px] text-center",children:`${t.toFixed(0)}%`}),(0,g.jsx)(He.A,{size:16})]})}function ka(){const e=(0,Vt.VH)().getZoom();return(0,g.jsxs)("div",{className:"flex flex-col items-center bg-white rounded-xl [&_.zoom-actions]:hover:flex",children:[(0,g.jsx)(ya,{}),(0,g.jsx)(Na,{zoomPercent:100*e})]})}function Aa(){return(0,g.jsx)("div",{className:"flex flex-row items-center",children:(0,g.jsx)(ka,{})})}const Ca="jail-78412641267",Sa={userNode:El,backgroundNode:function(){var e;const{room:t}=b();return(0,g.jsx)("div",{className:"flex flex-col pointer-events-none z-0",style:{width:3840,height:2160,backgroundImage:`url(${null===t||void 0===t||null===(e=t.background)||void 0===e?void 0:e.url})`,backgroundSize:"cover",backgroundRepeat:"no-repeat"}})},jailNode:function(){return(0,g.jsx)("div",{className:"flex flex-col pointer-events-none z-0",style:{width:3640,height:1700}})},shareSreenCard:function(e){const{data:t}=e;return(0,g.jsx)(Ol,{track:t.track})}};const _a=function(e){let{tracks:t}=e;const[s,l]=(0,i.useState)(),[n,a]=(0,i.useState)(),{user:r}=(0,ce.A)(),{room:o,updateUserCoords:d,room_id:c}=b(),u=(0,i.useMemo)((()=>{var e;return null!==(e=null===o||void 0===o?void 0:o.participants)&&void 0!==e?e:[]}),[null===o||void 0===o?void 0:o.participants]),x=(0,v.FO)(),h=(0,i.useRef)(!0),[p,j,w]=(0,Vt.ck)([]),y=(0,i.useCallback)((e=>[{id:"bg-node-4214242141",position:{x:-500,y:-700},type:"backgroundNode",draggable:!1,data:{},focusable:!1,deletable:!1,selectable:!1},{id:Ca,position:{x:-400,y:-400},type:"jailNode",draggable:!1,data:{},focusable:!1,deletable:!1,selectable:!1},...e]),[]),N=e=>(0,f.ar)(e.map((e=>{var s,l,i,a,o,d,c;const u=""+(null===e||void 0===e?void 0:e.username),x=null===e||void 0===e||null===(s=e.coordinates)||void 0===s?void 0:s.split(",");let m=null!==(l=null!==(i=null===n||void 0===n||null===(a=n.getNode(u))||void 0===a?void 0:a.position.x)&&void 0!==i?i:null===x||void 0===x?void 0:x[0])&&void 0!==l?l:200,f=null!==(o=null!==(d=null===n||void 0===n||null===(c=n.getNode(u))||void 0===c?void 0:c.position.y)&&void 0!==d?d:null===x||void 0===x?void 0:x[1])&&void 0!==o?o:200;"string"===typeof m&&(m=+m),"string"===typeof f&&(f=+f);t.find((t=>t.participant.identity===e.username));console.log("user",r),console.log("participant",e);const v=(null===r||void 0===r?void 0:r.username)===e.username;let h={id:""+(null===e||void 0===e?void 0:e.username),type:"userNode",data:{username:e.username,draggable:v,isDragging:!1},position:{x:m,y:f},parentId:Ca,extent:"parent"};return v||(h.draggable=!1),h})));(0,i.useEffect)((()=>{!1!==h.current&&(0!==u.length?(j(y(N(u))),h.current=!1):j(y([])))}),[u]),(0,i.useEffect)((()=>{j((e=>{var s;return[...e.filter((e=>"shareSreenCard"!==e.type)),...null===t||void 0===t||null===(s=t.filter((e=>e.source===Qs.CC.Source.ScreenShare)))||void 0===s?void 0:s.map(((e,t)=>{var s,l,i,a;return{id:"share-screen-"+t,type:"shareSreenCard",data:{track:e},position:{x:null!==(s=null===n||void 0===n||null===(l=n.getNode("share-screen-"+t))||void 0===l?void 0:l.position.x)&&void 0!==s?s:200,y:null!==(i=null===n||void 0===n||null===(a=n.getNode("share-screen-"+t))||void 0===a?void 0:a.position.y)&&void 0!==i?i:200},parentId:Ca,extent:"parent"}}))]}))}),[t]);const k=e=>{const t=null===e||void 0===e?void 0:e.username,s=null===e||void 0===e?void 0:e.coordinates;if(!t)return;if(!s)return;const l=s.split(",");if(2!==l.length)return;let n=l[0],i=l[1];d(t,{x:+n,y:+i}),j((e=>e.map((e=>e.id===t?{...e,position:{x:+n,y:+i}}:e))))};return(0,v.FO)("updateCoordinates",(e=>{k(e)}),[k]),(0,de.A)(ue.X.changeMyUserCoord,(e=>{k(e.data)})),(0,v.FO)("userLeftFromRoom",(e=>{const{room_id:t,user:s}=e;void 0!==c&&t===+c&&(j((e=>(0,f.ar)(e.filter((e=>e.id!==s.username))))),(null===r||void 0===r?void 0:r.id)!==s.id&&m("elseUserleft"))}),[]),(0,v.FO)("userJoinedToRoom",(e=>{const{room_id:t,user:s}=e;void 0!==c&&t===+c&&(j((e=>(0,f.ar)([...e,...N([s])]))),(null===r||void 0===r?void 0:r.id)!==s.id&&m("elseUserJoin"))}),[]),(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(Vt.Gc,{style:{width:"100%",height:"100%"},nodesDraggable:!0,onNodeDragStop:(e,t)=>{var s;if(null!==t&&void 0!==t&&null!==(s=t.data)&&void 0!==s&&s.draggable){const e=`${t.position.x},${t.position.y}`,s=t.data.username,l={room_id:null===o||void 0===o?void 0:o.id,coordinates:e,username:s};null===x||void 0===x||x.emit("updateCoordinates",l),(0,de.J)({type:ue.X.changeMyUserCoord,data:{...r,coordinates:e}});d(s,t.position)}},onNodesChange:e=>{w(e)},panOnDrag:!0,zoomOnScroll:!0,zoomOnPinch:!0,nodes:p,nodeTypes:Sa,onInit:a,viewport:s,onViewportChange:l,fitView:!0,translateExtent:[[-500,-500],[4e3,1600]],children:[(0,g.jsx)(Vt.VS,{}),(0,g.jsx)(Gl,{topLeft:(0,g.jsx)(Ln,{}),topRight:(0,g.jsx)(Qi,{}),bottomLeft:(0,g.jsx)(ca,{}),bottomMiddle:(0,g.jsx)(wa,{}),bottomRight:(0,g.jsx)(Aa,{})})]})})},Ra=()=>{const[e,t]=(0,i.useState)(!1),[s,l]=(0,i.useState)(),n=(0,Xs.t)([{source:Qs.CC.Source.Camera,withPlaceholder:!0},{source:Qs.CC.Source.ScreenShare,withPlaceholder:!1}],{updateOnlyOn:[Qs.u9.ActiveSpeakersChanged,Qs.u9.Reconnected,Qs.u9.Reconnecting,Qs.u9.MediaDevicesChanged,Qs.u9.LocalTrackPublished,Qs.u9.TrackUnsubscribed],onlySubscribed:!0});return(0,i.useEffect)((()=>{if(0===n.length)return;if(!0===e)return;l(null===n||void 0===n?void 0:n[0]),t(!0);const s=setTimeout((()=>{l(void 0)}),1e3);return()=>clearTimeout(s)}),[n,e]),(0,g.jsx)("div",{id:"canvas-board",className:"w-full h-[1080px] relative",children:(0,g.jsx)(nl.ag.Provider,{value:s,children:(0,g.jsx)(cl,{children:(0,g.jsx)(_a,{tracks:n})})})})};function Ea(){const e=(0,v.FO)(),{sidebar:t,joinRoom:s}=b();(0,i.useEffect)((()=>{const t=()=>{s()};return null===e||void 0===e||e.on("connect",t),()=>{null===e||void 0===e||e.off("connect",t)}}),[e,s]);let l="main-room-holder w-full h-screen overflow-hidden";return t&&(l+=" pr-[376px]"),(0,i.useEffect)((()=>{s()}),[]),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(sl,{}),(0,g.jsxs)("div",{id:"main-room-holder",className:l,children:[(0,g.jsx)("div",{className:"w-full   h-full relative",children:(0,g.jsx)(Ra,{})}),!!t&&(0,g.jsx)("div",{className:"fixed right-0 top-0 bottom-0 w-[376px] bg-white h-screen overflow-y-auto",children:(0,g.jsx)(y,{children:(0,g.jsx)(Ws,{})})}),(0,g.jsx)(Zs,{})]})]})}function za(e){let{onReTry:t}=e;return(0,i.useEffect)((()=>{const e=setInterval((()=>{(async()=>{t&&t()})()}),2e3);return()=>{clearTimeout(e)}}),[]),null}const La=function(){const{query:e}=o(),t=null===e||void 0===e?void 0:e.token,[s,l]=(0,i.useState)("Disconnected"),n=(0,nl.f)();return(0,i.useEffect)((()=>{const e=()=>{l(Qs.u9.Connected)},t=()=>{l(Qs.u9.Disconnected)},s=()=>{l(Qs.u9.Reconnecting)},i=()=>{l(Qs.u9.Reconnected)};return(async()=>{n&&(n.on(Qs.u9.Connected,e),n.on(Qs.u9.Disconnected,t),n.on(Qs.u9.Reconnecting,s),n.on(Qs.u9.Reconnected,i),n.on(Qs.u9.Reconnecting,s))})(),()=>{n&&(n.off(Qs.u9.Connected,e),n.off(Qs.u9.Disconnected,t),n.off(Qs.u9.Reconnecting,s),n.off(Qs.u9.Reconnected,i),n.off(Qs.u9.Reconnecting,s),n.disconnect())}}),[]),s==Qs.u9.Disconnected?(0,g.jsx)(za,{onReTry:()=>{Ut.c.serverUrl&&n.state!==Qs.KN.Connected&&n.connect(Ut.c.serverUrl,t)}}):null};function Ta(e){let t="[&_.right-4]:hidden";return e.dialogContentCss&&(t+=` ${e.dialogContentCss}`),(0,g.jsx)(Fs,{...e,dialogContentCss:t})}function Pa(){return(0,g.jsx)(Ta,{trigger:e=>(0,g.jsx)(L.A,{onClick:e,children:"Allow camera"}),dialogContentCss:"w-[780px] max-w-full",children:e=>(0,g.jsxs)("div",{className:"flex flex-col md:flex-row items-center gap-4 relative",children:[(0,g.jsx)(ee.A,{onClick:e,className:"absolute top-[-8px] right-[-8px]",children:(0,g.jsx)(D.A,{className:"text-black"})}),(0,g.jsx)("img",{src:"/assets/permissions-flag.svg",alt:"Permissions flag",width:322.5,height:322.5}),(0,g.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,g.jsx)("strong",{className:"text-xl",children:"Meet is blocked from using your camera!"}),(0,g.jsx)("p",{className:"text-base text-black/60",children:"Please allow that"})]})]})})}function Da(e){let{hasVideoAccess:t,hasVideoStream:s,videoNode:l}=e,n=(0,g.jsx)(g.Fragment,{children:l});return!1===t&&(n=(0,g.jsxs)("div",{className:"flex flex-col gap-y-2 items-center justify-center",children:[(0,g.jsx)("strong",{className:"text-xl",children:"Do you want people to see you in the meeting?"}),(0,g.jsx)(Pa,{})]})),s||(n=(0,g.jsx)("div",{className:"flex flex-col gap-y-2 items-center justify-center",children:(0,g.jsx)("strong",{className:"text-xl",children:"Camera is off"})})),(0,g.jsx)("div",{className:"w-full relative min-h-[300px] flex flex-col items-center justify-center bg-black/10 rounded-lg overflow-hidden",children:n})}const Ia=e=>{let{onChecked:t}=e;const s=(0,v.FO)(),{stream:l,stream_loading:n,enableVideoAccess:a,disableVideoAccess:r,enableAudioAccess:o,disableAudioAccess:d,changeStreamState:c}=Ha(),u=l.permissions,x=u.video,m=u.audio,f=l.videoStream,h=l.audioStream,p=(0,i.useRef)(null),j=(0,i.useRef)(!0),b=(0,i.useRef)(!0);(0,i.useEffect)((()=>{p.current&&f&&(p.current.srcObject=f)}),[f]),(0,i.useEffect)((()=>{j.current&&m&&(async()=>{const e=await navigator.mediaDevices.getUserMedia({audio:!0});c(e,"audio"),j.current=!1})()}),[m,j]),(0,i.useEffect)((()=>{b.current&&x&&((async()=>{const e=await navigator.mediaDevices.getUserMedia({video:!0});c(e,"video"),j.current=!1})(),b.current=!1)}),[x,b]);let w="text-black border bg-white";x&&f&&(w="!bg-destructive !text-white");let y="text-black border bg-white";return m&&h&&(y="!bg-destructive !text-white"),(0,g.jsxs)("div",{className:"flex flex-col gap-y-4 items-center w-[400px] max-w-full mx-auto my-8",children:[(0,g.jsx)("h2",{className:" text-xl font-bold",children:"Media Access"}),(0,g.jsx)(Da,{hasVideoAccess:!!x,hasVideoStream:null!==f,videoNode:(0,g.jsx)("video",{ref:p,autoPlay:!0,playsInline:!0,style:{width:"100%",maxWidth:"600px"}})}),(0,g.jsxs)("div",{className:"flex flex-row items-center gap-x-2",children:[(0,g.jsx)(ee.A,{disabled:n,variant:"default",className:w,onClick:()=>{f?r():a()},children:(0,g.jsx)(Me.A,{})}),(0,g.jsx)(ee.A,{disabled:n,variant:"default",className:y,onClick:()=>{h?d():o()},children:(0,g.jsx)(Oe.A,{})})]}),(0,g.jsx)("div",{children:(0,g.jsx)(L.A,{loading:!s,disabled:n,onClick:async()=>{t&&t()},className:"bg-blue-500 min-w-[100px]",children:"Join Now"})})]})};var $a=s(6362);function Ma(e){let{children:t}=e;const s=c(),l=(0,d.jL)();return(0,v.FO)("messageReceived",(e=>{console.log(e,"RECEIVED DATA");const t=null===e||void 0===e?void 0:e.is_direct;s.sounds.messageIncoming&&m("newMessage2"),l((0,$a.Ui)({message:e})),l((0,$a.Ih)({message:e,messageType:t?"direct":"room"}))}),[s.sounds.messageIncoming]),(0,v.FO)("messageSeen",(e=>{let t={...e.message,seen:!0};l((0,$a.Ui)({message:t}))})),(0,v.FO)("messageUpdated",(e=>{console.log(e,"MESSAGE UPDATED"),l((0,$a.Ui)({message:e}))})),(0,v.FO)("messageDeleted",(e=>{console.log(e,"MESSAGE Deleted"),l((0,$a.S1)({message:e}))})),(0,g.jsx)(g.Fragment,{children:t})}function Oa(e){let{onReTry:t}=e;return(0,i.useEffect)((()=>{const e=setInterval((()=>{(async()=>{t&&t()})()}),2e3);return()=>{clearTimeout(e)}}),[]),null}const Va={audio:!1,video:!1},Ua={loading:!1,permissions:Va,videoStream:null,audioStream:null},Fa=(0,i.createContext)({mediaPermissions:Va,enableVideoAccess:()=>{},enableAudioAccess:()=>{},disableVideoAccess:()=>{},disableAudioAccess:()=>{},changeStreamState:()=>{},stream:Ua,stream_loading:!1}),Ha=()=>(0,i.useContext)(Fa),Ja=(e,t)=>{switch(t.type){case"CHANGE_PERMISSION":const s=t.payload;return{...e,permissions:s};case"CHANGE_VALUES":case"CHANGE_VALUES":return{...e,...t.payload};case"START_LOADING":return{...e,loading:!0};case"STOP_LOADING":return{...e,loading:!1};default:return e}};function Ga(e){let{token:t,workspace_id:s,room_id:n,isReConnecting:a,isSwitching:r}=e;const[o,d]=(0,i.useReducer)(Ja,Ua),[c,u]=(0,i.useState)(!1);(0,i.useEffect)((()=>{(async()=>{try{var e;d({type:"START_LOADING"});const t=null!==(e=(await h.A.get("/users/settings")).data.data)&&void 0!==e?e:[];let s=t.find((e=>"video"===e.key)),l=t.find((e=>"audio"===e.key)),n="on"===(null===s||void 0===s?void 0:s.value),i="on"===(null===l||void 0===l?void 0:l.value);d({type:"CHANGE_VALUES",payload:{loading:!1,permissions:{video:n,audio:i}}})}catch(t){d({type:"STOP_LOADING"})}})()}),[]);let x=(0,g.jsxs)(l.L,{video:o.permissions.video,audio:!0,token:t,serverUrl:Ut.c.serverUrl,options:{publishDefaults:{videoEncoding:{maxBitrate:15e5,maxFramerate:30},screenShareEncoding:{maxBitrate:3e6,maxFramerate:60},dtx:!0,videoSimulcastLayers:[{width:640,height:360,resolution:{width:1280,height:720,frameRate:30},encoding:{maxBitrate:5e5,maxFramerate:20}},{width:320,height:180,resolution:{width:1280,height:720,frameRate:30},encoding:{maxBitrate:15e4,maxFramerate:15}}]},videoCaptureDefaults:{deviceId:"",facingMode:"user",resolution:{width:94,height:94,frameRate:30}},audioCaptureDefaults:{autoGainControl:!0,deviceId:"",echoCancellation:!0,noiseSuppression:!0,sampleRate:100}},children:[(0,g.jsx)(La,{}),(0,g.jsx)(Ea,{})]});const m=(0,v.FO)(),f=(0,i.useCallback)((async()=>{console.log("should join!"),console.log(m),null===m||void 0===m||m.emit("joinedRoom",n,(async()=>{h.A.get(`/rooms/${n}/join`).then((e=>{u(!0)})).catch((e=>{K.oR.error("Couldn't join to the room!")}))}))}),[m,n]);return!1!==c||a||r||(x=(0,g.jsx)(Ia,{onChecked:f})),(0,g.jsx)(Fa.Provider,{value:{mediaPermissions:{video:o.permissions.video,audio:o.permissions.audio},stream_loading:o.loading,changeStreamState:(e,t)=>{let s="";"video"===t&&(s="videoStream"),"audio"===t&&(s="audioStream"),s&&d({type:"CHANGE_VALUES",payload:{[s]:e}})},enableAudioAccess:async()=>{const e=o.permissions.video,t=o.videoStream;let s={video:!(!e||!t),audio:!0};try{d({type:"START_LOADING"}),await h.A.post("/settings",{key:"audio",value:"on"});const e=await navigator.mediaDevices.getUserMedia({audio:!0});d({type:"CHANGE_VALUES",payload:{loading:!1,permissions:s,audioStream:e}})}catch(l){d({type:"STOP_LOADING"})}},enableVideoAccess:async()=>{const e=o.permissions.audio,t=o.audioStream;let s={audio:!(!e||!t),video:!0};try{d({type:"START_LOADING"}),await h.A.post("/settings",{key:"video",value:"on"});const e=await navigator.mediaDevices.getUserMedia({video:!0});d({type:"CHANGE_VALUES",payload:{loading:!1,videoStream:e,permissions:s}})}catch(l){d({type:"STOP_LOADING"})}},disableAudioAccess:async()=>{const e=o.permissions.video,t=o.videoStream,s=o.audioStream;if(!s)return;let l={video:!(!e||!t),audio:!1};try{d({type:"START_LOADING"}),await h.A.post("/settings",{key:"audio",value:"off"});s.getTracks().forEach((e=>{e.stop()}));d({type:"CHANGE_VALUES",payload:{loading:!1,permissions:l,audioStream:null}})}catch(n){d({type:"STOP_LOADING"})}},disableVideoAccess:async()=>{const e=o.permissions.audio,t=o.audioStream,s=o.videoStream;if(!s)return;let l={audio:!(!e||!t),video:!1};try{d({type:"START_LOADING"}),await h.A.post("/settings",{key:"video",value:"off"});s.getTracks().forEach((e=>{e.stop()}));d({type:"CHANGE_VALUES",payload:{loading:!1,permissions:l,videoStream:null}})}catch(n){d({type:"STOP_LOADING"})}},stream:o},children:(0,g.jsx)(Vt.Ln,{children:(0,g.jsx)(Ma,{children:(0,g.jsxs)(w,{room_id:n,workspace_id:s,children:[!1===(null===m||void 0===m?void 0:m.connected)&&(0,g.jsx)(Oa,{onReTry:()=>{console.log("retry to connect!")}}),x]})})})})}function qa(e){let{children:t}=e;const s=(0,nl.ak)();return(0,g.jsx)(nl.aa.Provider,{value:s,children:t})}function Ba(e){let{token:t,workspace_id:s,room_id:l}=e;const{query:n}=o(),[a,r]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{null!==n&&void 0!==n&&n.isSwitching&&r(!0)}),[null===n||void 0===n?void 0:n.isSwitching]),(0,g.jsx)("div",{className:"max-h-screen",children:(0,g.jsx)(qa,{children:(0,g.jsx)(Ga,{token:t,room_id:l,workspace_id:s,isSwitching:a})})})}function Ya(){const{query:e}=o(),{workspace_id:t,room_id:s}=(0,p.g)();return console.log("query",e),t&&s?(0,g.jsx)(Ba,{token:null===e||void 0===e?void 0:e.token,workspace_id:t,room_id:+s}):null}}}]);
//# sourceMappingURL=888.5e0e430b.chunk.js.map